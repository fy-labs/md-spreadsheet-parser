
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A lightweight, pure Python library for parsing Markdown tables.">
      
      
      
        <link rel="canonical" href="https://f-y.github.io/md-spreadsheet-parser/api/">
      
      
        <link rel="prev" href="../COOKBOOK/">
      
      
      
        
          <link rel="alternate" href="./" hreflang="en">
        
          <link rel="alternate" href="../ja/api/" hreflang="ja">
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>API Reference - Markdown Spreadsheet Parser</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Markdown Spreadsheet Parser" class="md-header__button md-logo" aria-label="Markdown Spreadsheet Parser" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Markdown Spreadsheet Parser
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.9 17.39c-.26-.8-1.01-1.39-1.9-1.39h-1v-3a1 1 0 0 0-1-1H8v-2h2a1 1 0 0 0 1-1V7h2a2 2 0 0 0 2-2v-.41a7.984 7.984 0 0 1 2.9 12.8M11 19.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.22.21-1.79L9 15v1a2 2 0 0 0 2 2m1-16A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../ja/api/" hreflang="ja" class="md-select__link">
              日本語
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/f-y/md-spreadsheet-parser" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    f-y/md-spreadsheet-parser
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Markdown Spreadsheet Parser" class="md-nav__button md-logo" aria-label="Markdown Spreadsheet Parser" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Markdown Spreadsheet Parser
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/f-y/md-spreadsheet-parser" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    f-y/md-spreadsheet-parser
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../COOKBOOK/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cookbook
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#md_spreadsheet_parser" class="md-nav__link">
    <span class="md-ellipsis">
      
        md_spreadsheet_parser
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="md_spreadsheet_parser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.ConversionSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConversionSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.ExcelParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExcelParsingSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.MultiTableParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiTableParsingSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.ParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParsingSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sheet
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sheet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.add_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.delete_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.get_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.move_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.rename" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.replace_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.clear_column_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        clear_column_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.delete_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.delete_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.insert_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.insert_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.move_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.move_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.rename" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.to_models" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.update_cell" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_cell
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.TableValidationError" class="md-nav__link">
    <span class="md-ellipsis">
      
        TableValidationError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook" class="md-nav__link">
    <span class="md-ellipsis">
      
        Workbook
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Workbook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.add_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.delete_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.get_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.move_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.rename_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.replace_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generate_sheet_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_sheet_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generate_table_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_table_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generate_workbook_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_workbook_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_excel" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_excel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_excel_text" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_excel_text
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_table_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_table_from_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_workbook" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_workbook
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_workbook_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_workbook_from_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.scan_tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        scan_tables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.scan_tables_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        scan_tables_from_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.scan_tables_iter" class="md-nav__link">
    <span class="md-ellipsis">
      
        scan_tables_iter
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        schemas
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="schemas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.schemas.ConversionSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConversionSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.schemas.ExcelParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExcelParsingSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiTableParsingSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.schemas.ParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParsingSchema
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models" class="md-nav__link">
    <span class="md-ellipsis">
      
        models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sheet
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sheet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.add_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.delete_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.get_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.move_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.rename" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.replace_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.SheetJSON" class="md-nav__link">
    <span class="md-ellipsis">
      
        SheetJSON
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.clear_column_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        clear_column_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.delete_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.delete_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.insert_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.insert_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.move_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.move_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.rename" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.to_models" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.update_cell" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_cell
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.TableJSON" class="md-nav__link">
    <span class="md-ellipsis">
      
        TableJSON
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook" class="md-nav__link">
    <span class="md-ellipsis">
      
        Workbook
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Workbook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.add_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.delete_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.get_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.move_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.rename_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.replace_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.WorkbookJSON" class="md-nav__link">
    <span class="md-ellipsis">
      
        WorkbookJSON
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        validation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.validation.TableValidationError" class="md-nav__link">
    <span class="md-ellipsis">
      
        TableValidationError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.validation.validate_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_table
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generator" class="md-nav__link">
    <span class="md-ellipsis">
      
        generator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generator.generate_sheet_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_sheet_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generator.generate_table_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_table_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generator.generate_workbook_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_workbook_markdown
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#md_spreadsheet_parser" class="md-nav__link">
    <span class="md-ellipsis">
      
        md_spreadsheet_parser
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="md_spreadsheet_parser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.ConversionSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConversionSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.ExcelParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExcelParsingSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.MultiTableParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiTableParsingSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.ParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParsingSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sheet
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sheet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.add_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.delete_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.get_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.move_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.rename" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.replace_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Sheet.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.clear_column_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        clear_column_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.delete_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.delete_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.insert_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.insert_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.move_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.move_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.rename" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.to_models" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Table.update_cell" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_cell
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.TableValidationError" class="md-nav__link">
    <span class="md-ellipsis">
      
        TableValidationError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook" class="md-nav__link">
    <span class="md-ellipsis">
      
        Workbook
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Workbook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.add_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.delete_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.get_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.move_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.rename_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.replace_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.Workbook.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generate_sheet_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_sheet_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generate_table_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_table_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generate_workbook_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_workbook_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_excel" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_excel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_excel_text" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_excel_text
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_table_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_table_from_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_workbook" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_workbook
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.parse_workbook_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_workbook_from_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.scan_tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        scan_tables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.scan_tables_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        scan_tables_from_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.scan_tables_iter" class="md-nav__link">
    <span class="md-ellipsis">
      
        scan_tables_iter
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.schemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        schemas
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="schemas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.schemas.ConversionSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConversionSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.schemas.ExcelParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExcelParsingSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiTableParsingSchema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.schemas.ParsingSchema" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParsingSchema
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models" class="md-nav__link">
    <span class="md-ellipsis">
      
        models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sheet
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sheet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.add_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.delete_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.get_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.move_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.rename" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.replace_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Sheet.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.SheetJSON" class="md-nav__link">
    <span class="md-ellipsis">
      
        SheetJSON
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.clear_column_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        clear_column_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.delete_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.delete_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.insert_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.insert_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.move_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.move_row" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_row
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.rename" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.to_models" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Table.update_cell" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_cell
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.TableJSON" class="md-nav__link">
    <span class="md-ellipsis">
      
        TableJSON
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook" class="md-nav__link">
    <span class="md-ellipsis">
      
        Workbook
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Workbook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.json" class="md-nav__link">
    <span class="md-ellipsis">
      
        json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.add_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.delete_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.get_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.move_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        move_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.rename_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.replace_sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        replace_sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.Workbook.to_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_markdown
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.models.WorkbookJSON" class="md-nav__link">
    <span class="md-ellipsis">
      
        WorkbookJSON
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        validation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.validation.TableValidationError" class="md-nav__link">
    <span class="md-ellipsis">
      
        TableValidationError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.validation.validate_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_table
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generator" class="md-nav__link">
    <span class="md-ellipsis">
      
        generator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generator.generate_sheet_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_sheet_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generator.generate_table_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_table_markdown
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#md_spreadsheet_parser.generator.generate_workbook_markdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        generate_workbook_markdown
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API Reference</h1>


<div class="doc doc-object doc-module">



<h2 id="md_spreadsheet_parser" class="doc doc-heading">
            <code>md_spreadsheet_parser</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.ConversionSchema" class="doc doc-heading">
            <code>ConversionSchema</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Configuration for converting string values to Python types.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ConversionSchema.boolean_pairs">boolean_pairs</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>], ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pairs of strings representing (True, False). Case-insensitive.
           Example: <code>(("yes", "no"), ("on", "off"))</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ConversionSchema.custom_converters">custom_converters</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="type">type</span>, <span title="typing.Callable">Callable</span>[[<span title="str">str</span>], <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping ANY Python type to a conversion function <code>str -&gt; Any</code>.
               You can specify:
               - Built-in types: <code>int</code>, <code>float</code>, <code>bool</code> (to override default behavior)
               - Standard library types: <code>Decimal</code>, <code>datetime</code>, <code>date</code>, <code>ZoneInfo</code>
               - Custom classes: <code>MyClass</code>, <code>Product</code></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ConversionSchema.field_converters">field_converters</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Callable">Callable</span>[[<span title="str">str</span>], <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping field names (str) to conversion functions.
              Takes precedence over <code>custom_converters</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/schemas.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConversionSchema</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for converting string values to Python types.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        boolean_pairs: Pairs of strings representing (True, False). Case-insensitive.</span>
<span class="sd">                       Example: `((&quot;yes&quot;, &quot;no&quot;), (&quot;on&quot;, &quot;off&quot;))`.</span>
<span class="sd">        custom_converters: Dictionary mapping ANY Python type to a conversion function `str -&gt; Any`.</span>
<span class="sd">                           You can specify:</span>
<span class="sd">                           - Built-in types: `int`, `float`, `bool` (to override default behavior)</span>
<span class="sd">                           - Standard library types: `Decimal`, `datetime`, `date`, `ZoneInfo`</span>
<span class="sd">                           - Custom classes: `MyClass`, `Product`</span>
<span class="sd">        field_converters: Dictionary mapping field names (str) to conversion functions.</span>
<span class="sd">                          Takes precedence over `custom_converters`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">boolean_pairs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;[x]&quot;</span><span class="p">,</span> <span class="s2">&quot;[ ]&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">custom_converters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">field_converters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.ExcelParsingSchema" class="doc doc-heading">
            <code>ExcelParsingSchema</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Configuration for parsing Excel-exported data (TSV/CSV or openpyxl).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ExcelParsingSchema.header_rows">header_rows</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of header rows (1 or 2).
         If 2, headers are flattened to "Parent - Child" format.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ExcelParsingSchema.fill_merged_headers">fill_merged_headers</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to forward-fill empty header cells
                 (for merged cells in Excel exports).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ExcelParsingSchema.delimiter">delimiter</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column separator for TSV/CSV parsing. Default is tab.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ExcelParsingSchema.header_separator">header_separator</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Separator used when flattening 2-row headers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/schemas.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExcelParsingSchema</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for parsing Excel-exported data (TSV/CSV or openpyxl).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        header_rows: Number of header rows (1 or 2).</span>
<span class="sd">                     If 2, headers are flattened to &quot;Parent - Child&quot; format.</span>
<span class="sd">        fill_merged_headers: Whether to forward-fill empty header cells</span>
<span class="sd">                             (for merged cells in Excel exports).</span>
<span class="sd">        delimiter: Column separator for TSV/CSV parsing. Default is tab.</span>
<span class="sd">        header_separator: Separator used when flattening 2-row headers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">header_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">fill_merged_headers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
    <span class="n">header_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; - &quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_rows</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;header_rows must be 1 or 2&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.MultiTableParsingSchema" class="doc doc-heading">
            <code>MultiTableParsingSchema</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code></p>



        <p>Configuration for parsing multiple tables (workbook mode).
Inherits from ParsingSchema.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.MultiTableParsingSchema.root_marker">root_marker</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The marker indicating the start of the data section.
If None, auto-detection is used: single H1 → Workbook, or fallback to
"# Tables" / "# Workbook". Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.MultiTableParsingSchema.sheet_header_level">sheet_header_level</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The markdown header level for sheets.
If None, derived from workbook_level + 1. Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.MultiTableParsingSchema.table_header_level">table_header_level</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The markdown header level for tables.
If None, derived from workbook_level + 2. Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.MultiTableParsingSchema.capture_description">capture_description</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to capture text between the table header
and the table as a description. Defaults to True.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/schemas.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MultiTableParsingSchema</span><span class="p">(</span><span class="n">ParsingSchema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for parsing multiple tables (workbook mode).</span>
<span class="sd">    Inherits from ParsingSchema.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        root_marker (str | None): The marker indicating the start of the data section.</span>
<span class="sd">            If None, auto-detection is used: single H1 → Workbook, or fallback to</span>
<span class="sd">            &quot;# Tables&quot; / &quot;# Workbook&quot;. Defaults to None.</span>
<span class="sd">        sheet_header_level (int | None): The markdown header level for sheets.</span>
<span class="sd">            If None, derived from workbook_level + 1. Defaults to None.</span>
<span class="sd">        table_header_level (int | None): The markdown header level for tables.</span>
<span class="sd">            If None, derived from workbook_level + 2. Defaults to None.</span>
<span class="sd">        capture_description (bool): Whether to capture text between the table header</span>
<span class="sd">            and the table as a description. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">root_marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">sheet_header_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">table_header_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">capture_description</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Handle ParsingSchema defaults manually since they are separate fields in instance</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_separator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;column_separator&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_separator_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;header_separator_char&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_outer_pipes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;require_outer_pipes&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip_whitespace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;strip_whitespace&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_br_to_newline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;convert_br_to_newline&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># root_marker, sheet_header_level, table_header_level can all be None</span>
        <span class="c1"># (auto-detection is handled in parsing.py)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture_description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;capture_description&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.ParsingSchema" class="doc doc-heading">
            <code>ParsingSchema</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Configuration for parsing markdown tables.
Designed to be immutable and passed to pure functions.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ParsingSchema.column_separator">column_separator</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Character used to separate columns. Defaults to "|".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ParsingSchema.header_separator_char">header_separator_char</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Character used in the separator row. Defaults to "-".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ParsingSchema.require_outer_pipes">require_outer_pipes</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether tables must have outer pipes (e.g. <code>| col |</code>). Defaults to True.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.ParsingSchema.strip_whitespace">strip_whitespace</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to strip whitespace from cell values. Defaults to True.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/schemas.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ParsingSchema</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for parsing markdown tables.</span>
<span class="sd">    Designed to be immutable and passed to pure functions.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        column_separator (str): Character used to separate columns. Defaults to &quot;|&quot;.</span>
<span class="sd">        header_separator_char (str): Character used in the separator row. Defaults to &quot;-&quot;.</span>
<span class="sd">        require_outer_pipes (bool): Whether tables must have outer pipes (e.g. `| col |`). Defaults to True.</span>
<span class="sd">        strip_whitespace (bool): Whether to strip whitespace from cell values. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">column_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span>
    <span class="n">header_separator_char</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
    <span class="n">require_outer_pipes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">strip_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">convert_br_to_newline</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Ensure defaults if None is passed (e.g. from WASM)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_separator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;column_separator&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_separator_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;header_separator_char&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_outer_pipes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;require_outer_pipes&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip_whitespace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;strip_whitespace&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_br_to_newline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;convert_br_to_newline&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.Sheet" class="doc doc-heading">
            <code>Sheet</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Represents a single sheet containing tables.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Sheet.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the sheet.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Sheet.tables">tables</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tables contained in this sheet.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Sheet.sheet_type">sheet_type</span></code></td>
            <td>
                  <code><span title="md_spreadsheet_parser.models.SheetType">SheetType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of sheet - "table" for table sheet, "doc" for document sheet.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Sheet.content">content</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw markdown content for doc sheets. Only set when sheet_type="doc".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Sheet.metadata">metadata</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Arbitrary metadata (e.g. layout). Defaults to None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Sheet</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a single sheet containing tables.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name (str): Name of the sheet.</span>
<span class="sd">        tables (list[Table]): List of tables contained in this sheet.</span>
<span class="sd">        sheet_type (SheetType): Type of sheet - &quot;table&quot; for table sheet, &quot;doc&quot; for document sheet.</span>
<span class="sd">        content (str | None): Raw markdown content for doc sheets. Only set when sheet_type=&quot;doc&quot;.</span>
<span class="sd">        metadata (dict[str, Any] | None): Arbitrary metadata (e.g. layout). Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">tables</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">]</span>
    <span class="n">sheet_type</span><span class="p">:</span> <span class="n">SheetType</span> <span class="o">=</span> <span class="s2">&quot;table&quot;</span>
    <span class="n">content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Hack to allow default value for mutable type in frozen dataclass</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SheetJSON</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a JSON-compatible dictionary representation of the sheet.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SheetJSON: A dictionary containing the sheet data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;sheet_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheet_type</span><span class="p">,</span>
            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
            <span class="s2">&quot;tables&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">json</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">],</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{},</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve a table by its name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the table to retrieve.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Table | None: The table object if found, otherwise None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">table</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a Markdown string representation of the sheet.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The Markdown string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">generate_sheet_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Sheet with the name changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Sheet with a new empty table appended.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
        <span class="n">new_tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_table</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Sheet with the table at index removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Table index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
        <span class="n">new_tables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">replace_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="s2">&quot;Table&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Sheet with the table at index replaced.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Table index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
        <span class="n">new_tables</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Sheet with the table moved from from_index to to_index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">new_tables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
        <span class="n">new_tables</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="md_spreadsheet_parser.Sheet.json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns a JSON-compatible dictionary representation of the sheet.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>SheetJSON</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="SheetJSON (md_spreadsheet_parser.models.SheetJSON)" href="#md_spreadsheet_parser.models.SheetJSON">SheetJSON</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the sheet data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Sheet.add_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_table</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Sheet with a new empty table appended.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Sheet with a new empty table appended.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
    <span class="n">new_tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_table</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Sheet.delete_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_table</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Sheet with the table at index removed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Sheet with the table at index removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Table index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
    <span class="n">new_tables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Sheet.get_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_table</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieve a table by its name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table | None: The table object if found, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve a table by its name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): The name of the table to retrieve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table | None: The table object if found, otherwise None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">table</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Sheet.move_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_table</span><span class="p">(</span><span class="n">from_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Sheet with the table moved from from_index to to_index.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Sheet with the table moved from from_index to to_index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">new_tables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
    <span class="n">new_tables</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Sheet.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Sheet with the name changed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Sheet with the name changed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Sheet.replace_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">replace_table</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Sheet with the table at index replaced.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">replace_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="s2">&quot;Table&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Sheet with the table at index replaced.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Table index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
    <span class="n">new_tables</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Sheet.to_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_markdown</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_SCHEMA</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the sheet.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_SCHEMA">DEFAULT_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the sheet.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">generate_sheet_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.Table" class="doc doc-heading">
            <code>Table</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Represents a parsed table with optional metadata.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Table.headers">headers</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column headers, or None if the table has no headers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Table.rows">rows</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of data rows.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Table.alignments">alignments</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="md_spreadsheet_parser.models.AlignmentType">AlignmentType</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column alignments ('left', 'center', 'right'). Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Table.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the table (e.g. from a header). Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Table.description">description</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of the table. Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Table.metadata">metadata</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Arbitrary metadata. Defaults to None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a parsed table with optional metadata.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        headers (list[str] | None): List of column headers, or None if the table has no headers.</span>
<span class="sd">        rows (list[list[str]]): List of data rows.</span>
<span class="sd">        alignments (list[AlignmentType] | None): List of column alignments (&#39;left&#39;, &#39;center&#39;, &#39;right&#39;). Defaults to None.</span>
<span class="sd">        name (str | None): Name of the table (e.g. from a header). Defaults to None.</span>
<span class="sd">        description (str | None): Description of the table. Defaults to None.</span>
<span class="sd">        metadata (dict[str, Any] | None): Arbitrary metadata. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">headers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">rows</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="n">alignments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">start_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">end_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Hack to allow default value for mutable type in frozen dataclass</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TableJSON</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a JSON-compatible dictionary representation of the table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            TableJSON: A dictionary containing the table data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
            <span class="s2">&quot;rows&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{},</span>
            <span class="s2">&quot;start_line&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span><span class="p">,</span>
            <span class="s2">&quot;end_line&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_line</span><span class="p">,</span>
            <span class="s2">&quot;alignments&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_models</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">schema_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
        <span class="n">conversion_schema</span><span class="p">:</span> <span class="n">ConversionSchema</span> <span class="o">=</span> <span class="n">DEFAULT_CONVERSION_SCHEMA</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the table rows into a list of dataclass instances, performing validation and type conversion.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema_cls (type[T]): The dataclass type to validate against.</span>
<span class="sd">            conversion_schema (ConversionSchema, optional): Configuration for type conversion.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[T]: A list of validated dataclass instances.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If schema_cls is not a dataclass.</span>
<span class="sd">            TableValidationError: If validation fails for any row or if the table has no headers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">validate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema_cls</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a Markdown string representation of the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The Markdown string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">generate_table_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the specified cell updated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Handle header update</span>
        <span class="k">if</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Determine width from rows if possible, or start fresh</span>
                <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="k">else</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">new_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>
                <span class="c1"># Ensure width enough</span>
                <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
                    <span class="n">new_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
                    <span class="n">new_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

            <span class="c1"># Update alignments if headers grew</span>
            <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
                <span class="c1"># Fill with default/None up to new width</span>
                <span class="c1"># But we only need as many alignments as columns.</span>
                <span class="c1"># If alignments is None, it stays None?</span>
                <span class="c1"># Ideally if we start tracking alignments, we should init it?</span>
                <span class="c1"># If self.alignments was None, we might keep it None unless explicitly set?</span>
                <span class="c1"># Consistent behavior: If alignments is NOT None, expand it.</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Cast or explicit type check might be needed for strict type checkers with literals</span>
                    <span class="c1"># Using a typed list to satisfy invariant list[AlignmentType]</span>
                    <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>

            <span class="n">final_alignments</span> <span class="o">=</span> <span class="n">new_alignments</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="n">new_headers</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

            <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">final_alignments</span><span class="p">)</span>

        <span class="c1"># Handle Body update</span>
        <span class="c1"># 1. Ensure row exists</span>
        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>

        <span class="c1"># Grow rows if needed</span>
        <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
            <span class="c1"># Calculate width</span>
            <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
                <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># At least cover the new cell</span>

            <span class="n">rows_to_add</span> <span class="o">=</span> <span class="n">row_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows_to_add</span><span class="p">):</span>
                <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>

        <span class="c1"># If columns expanded due to row update, we might need to expand alignments too</span>
        <span class="n">current_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="n">current_width</span><span class="p">:</span>
            <span class="c1"># This means we are expanding columns</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">width_needed</span> <span class="o">=</span> <span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">current_align_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">width_needed</span> <span class="o">&gt;</span> <span class="n">current_align_len</span><span class="p">:</span>
                    <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
                    <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="n">width_needed</span> <span class="o">-</span> <span class="n">current_align_len</span>
                    <span class="p">)</span>
                    <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span>
                        <span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_rows_cell</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
                        <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span><span class="p">,</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_rows_cell</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_rows_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_rows</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">target_row</span> <span class="o">=</span> <span class="n">new_rows</span><span class="p">[</span><span class="n">row_idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_row</span><span class="p">):</span>
            <span class="n">target_row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_row</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">target_row</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">new_rows</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the row at index removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">row_idx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the column at index removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">new_headers</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
            <span class="n">new_headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>

        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
                <span class="n">new_row</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

        <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
                <span class="n">new_alignments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear_column_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with data in the specified column cleared (set to empty string),</span>
<span class="sd">        but headers and column structure preserved.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Headers remain unchanged</span>

        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
                <span class="n">new_row</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">insert_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with an empty row inserted at row_idx.</span>
<span class="sd">        Subsequent rows are shifted down.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>

        <span class="c1"># Determine width</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Default to 1 column if table is empty</span>

        <span class="n">new_row</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>

        <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">row_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
            <span class="n">row_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span>

        <span class="n">new_rows</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">new_row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">insert_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with an empty column inserted at col_idx.</span>
<span class="sd">        Subsequent columns are shifted right.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">new_headers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span>
            <span class="n">new_headers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">col_idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
            <span class="c1"># Pad if needed before insertion?</span>
            <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
                <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>
            <span class="n">new_alignments</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">col_idx</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">)</span>  <span class="c1"># Default alignment</span>

        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="c1"># Ensure row is long enough before insertion logic?</span>
            <span class="c1"># Or just insert.</span>
            <span class="c1"># If col_idx is way past end, we might need padding?</span>
            <span class="c1"># Standard list.insert handles index &gt; len -&gt; append.</span>
            <span class="n">current_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>
            <span class="n">target_idx</span> <span class="o">=</span> <span class="n">col_idx</span>
            <span class="k">if</span> <span class="n">target_idx</span> <span class="o">&gt;</span> <span class="n">current_len</span><span class="p">:</span>
                <span class="c1"># Pad up to target</span>
                <span class="n">new_row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">target_idx</span> <span class="o">-</span> <span class="n">current_len</span><span class="p">))</span>
                <span class="n">target_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>  <span class="c1"># Append</span>

            <span class="n">new_row</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">target_idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the name changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the row moved from from_index to to_index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">new_rows</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the column moved from from_index to to_index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Determine width from headers or first row</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
            <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

        <span class="c1"># Move header</span>
        <span class="n">new_headers</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">new_headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
            <span class="n">new_headers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>

        <span class="c1"># Move alignments</span>
        <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">:</span>
            <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
                <span class="n">alignment</span> <span class="o">=</span> <span class="n">new_alignments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
                <span class="n">new_alignments</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span>

        <span class="c1"># Move data in each row</span>
        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">new_row</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
                <span class="n">new_row</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="md_spreadsheet_parser.Table.json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns a JSON-compatible dictionary representation of the table.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>TableJSON</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="TableJSON (md_spreadsheet_parser.models.TableJSON)" href="#md_spreadsheet_parser.models.TableJSON">TableJSON</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the table data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.clear_column_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clear_column_data</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with data in the specified column cleared (set to empty string),
but headers and column structure preserved.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_column_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with data in the specified column cleared (set to empty string),</span>
<span class="sd">    but headers and column structure preserved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Headers remain unchanged</span>

    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
            <span class="n">new_row</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.delete_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_column</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the column at index removed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the column at index removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">new_headers</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
        <span class="n">new_headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>

    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
            <span class="n">new_row</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

    <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
            <span class="n">new_alignments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.delete_row" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_row</span><span class="p">(</span><span class="n">row_idx</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the row at index removed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the row at index removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">row_idx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.insert_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insert_column</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with an empty column inserted at col_idx.
Subsequent columns are shifted right.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">insert_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with an empty column inserted at col_idx.</span>
<span class="sd">    Subsequent columns are shifted right.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">new_headers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">col_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
            <span class="n">col_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span>
        <span class="n">new_headers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">col_idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
        <span class="c1"># Pad if needed before insertion?</span>
        <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
            <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>
        <span class="n">new_alignments</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">col_idx</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">)</span>  <span class="c1"># Default alignment</span>

    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="c1"># Ensure row is long enough before insertion logic?</span>
        <span class="c1"># Or just insert.</span>
        <span class="c1"># If col_idx is way past end, we might need padding?</span>
        <span class="c1"># Standard list.insert handles index &gt; len -&gt; append.</span>
        <span class="n">current_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>
        <span class="n">target_idx</span> <span class="o">=</span> <span class="n">col_idx</span>
        <span class="k">if</span> <span class="n">target_idx</span> <span class="o">&gt;</span> <span class="n">current_len</span><span class="p">:</span>
            <span class="c1"># Pad up to target</span>
            <span class="n">new_row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">target_idx</span> <span class="o">-</span> <span class="n">current_len</span><span class="p">))</span>
            <span class="n">target_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>  <span class="c1"># Append</span>

        <span class="n">new_row</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">target_idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.insert_row" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insert_row</span><span class="p">(</span><span class="n">row_idx</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with an empty row inserted at row_idx.
Subsequent rows are shifted down.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">insert_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with an empty row inserted at row_idx.</span>
<span class="sd">    Subsequent rows are shifted down.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>

    <span class="c1"># Determine width</span>
    <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Default to 1 column if table is empty</span>

    <span class="n">new_row</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>

    <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">row_idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
        <span class="n">row_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span>

    <span class="n">new_rows</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">new_row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.move_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_column</span><span class="p">(</span><span class="n">from_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the column moved from from_index to to_index.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the column moved from from_index to to_index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Determine width from headers or first row</span>
    <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
        <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

    <span class="c1"># Move header</span>
    <span class="n">new_headers</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
        <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">new_headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
        <span class="n">new_headers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>

    <span class="c1"># Move alignments</span>
    <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">:</span>
        <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
            <span class="n">alignment</span> <span class="o">=</span> <span class="n">new_alignments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
            <span class="n">new_alignments</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span>

    <span class="c1"># Move data in each row</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">new_row</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
            <span class="n">new_row</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.move_row" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_row</span><span class="p">(</span><span class="n">from_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the row moved from from_index to to_index.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the row moved from from_index to to_index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">new_rows</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
    <span class="n">new_rows</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the name changed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the name changed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.to_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_markdown</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_SCHEMA</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_SCHEMA">DEFAULT_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">generate_table_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.to_models" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_models</span><span class="p">(</span><span class="n">schema_cls</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="o">=</span><span class="n">DEFAULT_CONVERSION_SCHEMA</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Converts the table rows into a list of dataclass instances, performing validation and type conversion.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema_cls</code>
            </td>
            <td>
                  <code><span title="type">type</span>[<span title="md_spreadsheet_parser.models.T">T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataclass type to validate against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conversion_schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConversionSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ConversionSchema)" href="#md_spreadsheet_parser.schemas.ConversionSchema">ConversionSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for type conversion.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_CONVERSION_SCHEMA">DEFAULT_CONVERSION_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="md_spreadsheet_parser.models.T">T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[T]: A list of validated dataclass instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If schema_cls is not a dataclass.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="TableValidationError (md_spreadsheet_parser.validation.TableValidationError)" href="#md_spreadsheet_parser.validation.TableValidationError">TableValidationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If validation fails for any row or if the table has no headers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_models</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">schema_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
    <span class="n">conversion_schema</span><span class="p">:</span> <span class="n">ConversionSchema</span> <span class="o">=</span> <span class="n">DEFAULT_CONVERSION_SCHEMA</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the table rows into a list of dataclass instances, performing validation and type conversion.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema_cls (type[T]): The dataclass type to validate against.</span>
<span class="sd">        conversion_schema (ConversionSchema, optional): Configuration for type conversion.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[T]: A list of validated dataclass instances.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If schema_cls is not a dataclass.</span>
<span class="sd">        TableValidationError: If validation fails for any row or if the table has no headers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">validate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema_cls</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Table.update_cell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_cell</span><span class="p">(</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the specified cell updated.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the specified cell updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Handle header update</span>
    <span class="k">if</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Determine width from rows if possible, or start fresh</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="k">else</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">new_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>
            <span class="c1"># Ensure width enough</span>
            <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
                <span class="n">new_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
                <span class="n">new_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1"># Update alignments if headers grew</span>
        <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
            <span class="c1"># Fill with default/None up to new width</span>
            <span class="c1"># But we only need as many alignments as columns.</span>
            <span class="c1"># If alignments is None, it stays None?</span>
            <span class="c1"># Ideally if we start tracking alignments, we should init it?</span>
            <span class="c1"># If self.alignments was None, we might keep it None unless explicitly set?</span>
            <span class="c1"># Consistent behavior: If alignments is NOT None, expand it.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Cast or explicit type check might be needed for strict type checkers with literals</span>
                <span class="c1"># Using a typed list to satisfy invariant list[AlignmentType]</span>
                <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>

        <span class="n">final_alignments</span> <span class="o">=</span> <span class="n">new_alignments</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="n">new_headers</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">final_alignments</span><span class="p">)</span>

    <span class="c1"># Handle Body update</span>
    <span class="c1"># 1. Ensure row exists</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>

    <span class="c1"># Grow rows if needed</span>
    <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
        <span class="c1"># Calculate width</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
            <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># At least cover the new cell</span>

        <span class="n">rows_to_add</span> <span class="o">=</span> <span class="n">row_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows_to_add</span><span class="p">):</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>

    <span class="c1"># If columns expanded due to row update, we might need to expand alignments too</span>
    <span class="n">current_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="n">current_width</span><span class="p">:</span>
        <span class="c1"># This means we are expanding columns</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">width_needed</span> <span class="o">=</span> <span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">current_align_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">width_needed</span> <span class="o">&gt;</span> <span class="n">current_align_len</span><span class="p">:</span>
                <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
                <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="n">width_needed</span> <span class="o">-</span> <span class="n">current_align_len</span>
                <span class="p">)</span>
                <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span>
                    <span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_rows_cell</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
                    <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_rows_cell</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.TableValidationError" class="doc doc-heading">
            <code>TableValidationError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>



        <p>Exception raised when table validation fails.
Contains a list of errors found during validation.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/validation.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TableValidationError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exception raised when table validation fails.</span>
<span class="sd">    Contains a list of errors found during validation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Validation failed with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2"> errors:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.Workbook" class="doc doc-heading">
            <code>Workbook</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Represents a collection of sheets (multi-table output).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Workbook.sheets">sheets</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Sheet


  
      dataclass
   (md_spreadsheet_parser.models.Sheet)" href="#md_spreadsheet_parser.models.Sheet">Sheet</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of sheets in the workbook.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Workbook.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the workbook (extracted from root marker). Defaults to "Workbook".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Workbook.start_line">start_line</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-indexed line number where workbook header starts. None if not detected.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Workbook.end_line">end_line</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-indexed line number where workbook section ends. None if not detected.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.Workbook.metadata">metadata</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Arbitrary metadata. Defaults to None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Workbook</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a collection of sheets (multi-table output).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        sheets (list[Sheet]): List of sheets in the workbook.</span>
<span class="sd">        name (str): Name of the workbook (extracted from root marker). Defaults to &quot;Workbook&quot;.</span>
<span class="sd">        start_line (int | None): 0-indexed line number where workbook header starts. None if not detected.</span>
<span class="sd">        end_line (int | None): 0-indexed line number where workbook section ends. None if not detected.</span>
<span class="sd">        metadata (dict[str, Any] | None): Arbitrary metadata. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sheets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Sheet</span><span class="p">]</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Workbook&quot;</span>
    <span class="n">start_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">end_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">root_content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Hack to allow default value for mutable type in frozen dataclass</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WorkbookJSON</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a JSON-compatible dictionary representation of the workbook.</span>

<span class="sd">        Returns:</span>
<span class="sd">            WorkbookJSON: A dictionary containing the workbook data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">WorkbookJSON</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;sheets&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">json</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">],</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{},</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;startLine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;endLine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_line</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;rootContent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_content</span>  <span class="c1"># type: ignore[typeddict-item]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sheet</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve a sheet by its name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the sheet to retrieve.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Sheet | None: The sheet object if found, otherwise None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sheet</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sheet</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_MULTI_TABLE_SCHEMA</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a Markdown string representation of the workbook.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (MultiTableParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The Markdown string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">generate_workbook_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Workbook with a new sheet added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create new sheet with one empty table as default</span>
        <span class="n">new_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]])</span>
        <span class="n">new_sheet</span> <span class="o">=</span> <span class="n">Sheet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="n">new_table</span><span class="p">])</span>

        <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
        <span class="n">new_sheets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_sheet</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Workbook with the sheet at index removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
        <span class="n">new_sheets</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Workbook with the sheet moved from from_index to to_index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="n">new_sheets</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
        <span class="n">new_sheets</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">sheet</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">replace_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sheet</span><span class="p">:</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Workbook with the sheet at index replaced.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
        <span class="n">new_sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">sheet</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rename_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Workbook with the sheet at index renamed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

        <span class="n">old_sheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">new_sheet</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">old_sheet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>

        <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
        <span class="n">new_sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_sheet</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="md_spreadsheet_parser.Workbook.json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns a JSON-compatible dictionary representation of the workbook.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>WorkbookJSON</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="WorkbookJSON (md_spreadsheet_parser.models.WorkbookJSON)" href="#md_spreadsheet_parser.models.WorkbookJSON">WorkbookJSON</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the workbook data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Workbook.add_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_sheet</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Workbook with a new sheet added.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Workbook with a new sheet added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create new sheet with one empty table as default</span>
    <span class="n">new_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]])</span>
    <span class="n">new_sheet</span> <span class="o">=</span> <span class="n">Sheet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="n">new_table</span><span class="p">])</span>

    <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
    <span class="n">new_sheets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_sheet</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Workbook.delete_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_sheet</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Workbook with the sheet at index removed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Workbook with the sheet at index removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
    <span class="n">new_sheets</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Workbook.get_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sheet</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieve a sheet by its name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the sheet to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Sheet


  
      dataclass
   (md_spreadsheet_parser.models.Sheet)" href="#md_spreadsheet_parser.models.Sheet">Sheet</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sheet | None: The sheet object if found, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sheet</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve a sheet by its name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): The name of the sheet to retrieve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Sheet | None: The sheet object if found, otherwise None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sheet</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sheet</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Workbook.move_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_sheet</span><span class="p">(</span><span class="n">from_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Workbook with the sheet moved from from_index to to_index.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Workbook with the sheet moved from from_index to to_index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">new_sheets</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
    <span class="n">new_sheets</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">sheet</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Workbook.rename_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename_sheet</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Workbook with the sheet at index renamed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rename_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Workbook with the sheet at index renamed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

    <span class="n">old_sheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">new_sheet</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">old_sheet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>

    <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
    <span class="n">new_sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_sheet</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Workbook.replace_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">replace_sheet</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">sheet</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Workbook with the sheet at index replaced.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">replace_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sheet</span><span class="p">:</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Workbook with the sheet at index replaced.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
    <span class="n">new_sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">sheet</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.Workbook.to_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_markdown</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_MULTI_TABLE_SCHEMA</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the workbook.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MultiTableParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.MultiTableParsingSchema)" href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema">MultiTableParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_MULTI_TABLE_SCHEMA">DEFAULT_MULTI_TABLE_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_MULTI_TABLE_SCHEMA</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the workbook.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (MultiTableParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">generate_workbook_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.generate_sheet_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_sheet_markdown</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_SCHEMA</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the sheet.</p>
<p>For doc sheets (type="doc"), outputs the content directly.
For table sheets (type="table"), outputs table markdown.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sheet</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Sheet


  
      dataclass
   (md_spreadsheet_parser.models.Sheet)" href="#md_spreadsheet_parser.models.Sheet">Sheet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Sheet object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_SCHEMA">DEFAULT_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_sheet_markdown</span><span class="p">(</span>
    <span class="n">sheet</span><span class="p">:</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the sheet.</span>

<span class="sd">    For doc sheets (type=&quot;doc&quot;), outputs the content directly.</span>
<span class="sd">    For table sheets (type=&quot;table&quot;), outputs table markdown.</span>

<span class="sd">    Args:</span>
<span class="sd">        sheet: The Sheet object.</span>
<span class="sd">        schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">MultiTableParsingSchema</span><span class="p">):</span>
        <span class="n">sheet_level</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">sheet_header_level</span> <span class="ow">or</span> <span class="mi">2</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;#&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sheet_level</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sheet</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># For doc sheets, output content directly</span>
    <span class="k">if</span> <span class="n">sheet</span><span class="o">.</span><span class="n">sheet_type</span> <span class="o">==</span> <span class="s2">&quot;doc&quot;</span> <span class="ow">and</span> <span class="n">sheet</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Table sheet: output tables</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">table</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generate_table_markdown</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">schema</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Empty line between tables</span>

    <span class="c1"># Append Sheet Metadata if present (at the end)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">MultiTableParsingSchema</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sheet</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">metadata_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;!-- md-spreadsheet-sheet-metadata: </span><span class="si">{</span><span class="n">metadata_json</span><span class="si">}</span><span class="s2"> --&gt;&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.generate_table_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_table_markdown</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_SCHEMA</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_SCHEMA">DEFAULT_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_table_markdown</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="s2">&quot;Table&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: The Table object.</span>
<span class="sd">        schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Handle metadata (name and description) if MultiTableParsingSchema</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">MultiTableParsingSchema</span><span class="p">):</span>
        <span class="n">table_level</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">table_header_level</span>
        <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="n">table_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;#&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">table_level</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Empty line after name</span>

        <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">description</span> <span class="ow">and</span> <span class="n">schema</span><span class="o">.</span><span class="n">capture_description</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Empty line after description</span>

    <span class="c1"># Build table</span>

    <span class="n">sep</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2"> &quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare cell for markdown generation.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">convert_br_to_newline</span> <span class="ow">and</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">cell</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cell</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cell</span>

    <span class="c1"># Headers</span>
    <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
        <span class="c1"># Add outer pipes if required</span>
        <span class="n">processed_headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">_prepare_cell</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
        <span class="n">header_row</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">processed_headers</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">require_outer_pipes</span><span class="p">:</span>
            <span class="n">header_row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">header_row</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header_row</span><span class="p">)</span>

        <span class="c1"># Separator row</span>
        <span class="n">separator_cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">separator_char</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">header_separator_char</span> <span class="ow">or</span> <span class="s2">&quot;-&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">):</span>
            <span class="n">alignment</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
            <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">alignments</span><span class="p">):</span>
                <span class="c1"># Ensure we handle potentially None values if list has gaps (unlikely by design but safe)</span>
                <span class="n">alignment</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">alignments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;default&quot;</span>

            <span class="c1"># Construct separator cell based on alignment</span>
            <span class="c1"># Use 3 hyphens as base</span>
            <span class="k">if</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">separator_char</span> <span class="o">*</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">separator_char</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
            <span class="k">elif</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">separator_char</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># default</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">separator_char</span> <span class="o">*</span> <span class="mi">3</span>

            <span class="n">separator_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

        <span class="n">separator_row</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">separator_cells</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">require_outer_pipes</span><span class="p">:</span>
            <span class="n">separator_row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">separator_row</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator_row</span><span class="p">)</span>

    <span class="c1"># Rows</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">processed_row</span> <span class="o">=</span> <span class="p">[</span><span class="n">_prepare_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
        <span class="n">row_str</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">processed_row</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">require_outer_pipes</span><span class="p">:</span>
            <span class="n">row_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">row_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_str</span><span class="p">)</span>

    <span class="c1"># Append Metadata if present</span>
    <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">and</span> <span class="s2">&quot;visual&quot;</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
        <span class="n">metadata_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;visual&quot;</span><span class="p">],</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;!-- md-spreadsheet-table-metadata: </span><span class="si">{</span><span class="n">metadata_json</span><span class="si">}</span><span class="s2"> --&gt;&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.generate_workbook_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_workbook_markdown</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the workbook.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>workbook</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Workbook


  
      dataclass
   (md_spreadsheet_parser.models.Workbook)" href="#md_spreadsheet_parser.models.Workbook">Workbook</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Workbook object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MultiTableParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.MultiTableParsingSchema)" href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema">MultiTableParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_workbook_markdown</span><span class="p">(</span>
    <span class="n">workbook</span><span class="p">:</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the workbook.</span>

<span class="sd">    Args:</span>
<span class="sd">        workbook: The Workbook object.</span>
<span class="sd">        schema (MultiTableParsingSchema): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="n">is_frontmatter</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header_type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;frontmatter&quot;</span>

    <span class="k">if</span> <span class="n">is_frontmatter</span><span class="p">:</span>
        <span class="c1"># Output YAML frontmatter block</span>
        <span class="n">frontmatter_data</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;frontmatter&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">frontmatter_data</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generate_yaml_frontmatter</span><span class="p">(</span><span class="n">frontmatter_data</span><span class="p">))</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">schema</span><span class="o">.</span><span class="n">root_marker</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">root_marker</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Default: generate root marker from workbook name</span>
        <span class="n">root_marker_level</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">schema</span><span class="o">.</span><span class="n">sheet_header_level</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">sheet_header_level</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;#&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">root_marker_level</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">workbook</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">workbook</span><span class="o">.</span><span class="n">root_content</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">workbook</span><span class="o">.</span><span class="n">root_content</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">workbook</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generate_sheet_markdown</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">schema</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">workbook</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Empty line between sheets</span>

    <span class="c1"># Append Workbook Metadata if present (excluding internal keys)</span>
    <span class="n">comment_metadata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_METADATA_INTERNAL_KEYS</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">comment_metadata</span><span class="p">:</span>
        <span class="c1"># Ensure separation from last sheet</span>
        <span class="k">if</span> <span class="n">lines</span> <span class="ow">and</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">metadata_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">comment_metadata</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;!-- md-spreadsheet-workbook-metadata: </span><span class="si">{</span><span class="n">metadata_json</span><span class="si">}</span><span class="s2"> --&gt;&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.parse_excel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_excel</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_EXCEL_SCHEMA</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse Excel data from various sources.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.excel.ExcelSource">ExcelSource</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>One of:
- openpyxl.Worksheet (if openpyxl is installed)
- str: TSV/CSV text content
- list[list[str]]: Pre-parsed 2D array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ExcelParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ExcelParsingSchema)" href="#md_spreadsheet_parser.schemas.ExcelParsingSchema">ExcelParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for parsing.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_EXCEL_SCHEMA">DEFAULT_EXCEL_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table object with processed headers and data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If source type is not supported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/excel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_excel</span><span class="p">(</span>
    <span class="n">source</span><span class="p">:</span> <span class="n">ExcelSource</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="n">ExcelParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_EXCEL_SCHEMA</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse Excel data from various sources.</span>

<span class="sd">    Args:</span>
<span class="sd">        source: One of:</span>
<span class="sd">            - openpyxl.Worksheet (if openpyxl is installed)</span>
<span class="sd">            - str: TSV/CSV text content</span>
<span class="sd">            - list[list[str]]: Pre-parsed 2D array</span>
<span class="sd">        schema: Configuration for parsing.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table object with processed headers and data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If source type is not supported.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rows</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>

    <span class="c1"># Check for openpyxl Worksheet (duck typing via hasattr)</span>
    <span class="k">if</span> <span class="n">HAS_OPENPYXL</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s2">&quot;iter_rows&quot;</span><span class="p">):</span>
        <span class="c1"># At runtime, source is a Worksheet with iter_rows method</span>
        <span class="n">ws</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">source</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="n">_safe_str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">values_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="c1"># Check for string (TSV/CSV content)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">_parse_tsv</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">schema</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

    <span class="c1"># Check for pre-parsed 2D array</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="c1"># Assume it&#39;s already list[list[str]]</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">source</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">supported</span> <span class="o">=</span> <span class="s2">&quot;openpyxl.Worksheet, str, or list[list[str]]&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">HAS_OPENPYXL</span><span class="p">:</span>
            <span class="n">supported</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;str or list[list[str]] (install openpyxl for Worksheet support)&quot;</span>
            <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unsupported source type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">supported</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">parse_excel_text</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.parse_excel_text" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_excel_text</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_EXCEL_SCHEMA</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse a 2D string array into a Table with merged cell and header handling.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rows</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>2D list of strings (e.g., from csv.reader or worksheet iteration).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ExcelParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ExcelParsingSchema)" href="#md_spreadsheet_parser.schemas.ExcelParsingSchema">ExcelParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for header processing.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_EXCEL_SCHEMA">DEFAULT_EXCEL_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table object with processed headers and data rows.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/excel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_excel_text</span><span class="p">(</span>
    <span class="n">rows</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">schema</span><span class="p">:</span> <span class="n">ExcelParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_EXCEL_SCHEMA</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse a 2D string array into a Table with merged cell and header handling.</span>

<span class="sd">    Args:</span>
<span class="sd">        rows: 2D list of strings (e.g., from csv.reader or worksheet iteration).</span>
<span class="sd">        schema: Configuration for header processing.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table object with processed headers and data rows.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">rows</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">header_rows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Single header row</span>
        <span class="n">header_row</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">fill_merged_headers</span><span class="p">:</span>
            <span class="n">header_row</span> <span class="o">=</span> <span class="n">_forward_fill</span><span class="p">(</span><span class="n">header_row</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">header_row</span>
        <span class="n">data_rows</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">elif</span> <span class="n">schema</span><span class="o">.</span><span class="n">header_rows</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># Two header rows: Parent-Child flattening</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># Not enough rows for 2-row header</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">rows</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="p">[])</span>

        <span class="n">parent_row</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">child_row</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">fill_merged_headers</span><span class="p">:</span>
            <span class="n">parent_row</span> <span class="o">=</span> <span class="n">_forward_fill</span><span class="p">(</span><span class="n">parent_row</span><span class="p">)</span>

        <span class="n">headers</span> <span class="o">=</span> <span class="n">_flatten_headers</span><span class="p">(</span><span class="n">parent_row</span><span class="p">,</span> <span class="n">child_row</span><span class="p">,</span> <span class="n">schema</span><span class="o">.</span><span class="n">header_separator</span><span class="p">)</span>
        <span class="n">data_rows</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Should not reach here due to schema validation</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid header_rows: </span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">header_rows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Convert data_rows to list[list[str]] ensuring all are strings</span>
    <span class="n">processed_rows</span> <span class="o">=</span> <span class="p">[[</span><span class="n">_safe_str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_rows</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">processed_rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.parse_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_sheet</span><span class="p">(</span><span class="n">markdown</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">start_line_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse a sheet (section) containing one or more tables.</p>
<p>If the section contains valid tables, sheet_type="table" and content=None.
If no tables are found, sheet_type="doc" and content stores the raw markdown.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/parsing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_sheet</span><span class="p">(</span>
    <span class="n">markdown</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span><span class="p">,</span>
    <span class="n">start_line_offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sheet</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse a sheet (section) containing one or more tables.</span>

<span class="sd">    If the section contains valid tables, sheet_type=&quot;table&quot; and content=None.</span>
<span class="sd">    If no tables are found, sheet_type=&quot;doc&quot; and content stores the raw markdown.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Scan for sheet metadata</span>
    <span class="c1"># We prioritize the first match if multiple exist (though usually only one)</span>
    <span class="n">metadata_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;^&lt;!-- md-spreadsheet-sheet-metadata: (.*) --&gt;$&quot;</span><span class="p">,</span> <span class="n">markdown</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">metadata_match</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">metadata_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># Ignore invalid JSON</span>

    <span class="n">tables</span> <span class="o">=</span> <span class="n">_extract_tables</span><span class="p">(</span><span class="n">markdown</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">start_line_offset</span><span class="p">)</span>

    <span class="c1"># Determine sheet type based on whether tables were found</span>
    <span class="k">if</span> <span class="n">tables</span><span class="p">:</span>
        <span class="c1"># Table sheet: store tables but not raw content</span>
        <span class="k">return</span> <span class="n">Sheet</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">tables</span><span class="o">=</span><span class="n">tables</span><span class="p">,</span>
            <span class="n">sheet_type</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Doc sheet: no tables, store the raw markdown content</span>
        <span class="k">return</span> <span class="n">Sheet</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">tables</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">sheet_type</span><span class="o">=</span><span class="s2">&quot;doc&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">markdown</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">if</span> <span class="n">markdown</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.parse_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_table</span><span class="p">(</span><span class="n">markdown</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_SCHEMA</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse a markdown table into a Table object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>markdown</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The markdown string containing the table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for parsing.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_SCHEMA">DEFAULT_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table object with headers and rows.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/parsing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_table</span><span class="p">(</span><span class="n">markdown</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse a markdown table into a Table object.</span>

<span class="sd">    Args:</span>
<span class="sd">        markdown: The markdown string containing the table.</span>
<span class="sd">        schema: Configuration for parsing.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table object with headers and rows.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">markdown</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">headers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">rows</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">alignments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">potential_header</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">visual_metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Buffer for potential header row until we confirm it&#39;s a header with a separator</span>
    <span class="n">potential_header</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Check for metadata comment</span>
        <span class="n">metadata_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;^&lt;!-- md-spreadsheet-table-metadata: (.*) --&gt;$&quot;</span><span class="p">,</span> <span class="n">line</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">metadata_match</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">json_content</span> <span class="o">=</span> <span class="n">metadata_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">visual_metadata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_content</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
                <span class="c1"># If invalid JSON, treat as normal text/comment (or ignore?)</span>
                <span class="c1"># For robustness, we ignore it as metadata but let parse_row handle it or skip?</span>
                <span class="c1"># Usually comments are ignored by parse_row if they don&#39;t look like tables?</span>
                <span class="c1"># parse_row will likely return [&quot;&lt;!-- ... --&gt;&quot;].</span>
                <span class="c1"># If we want to hide it from table data, we should continue here even if error?</span>
                <span class="c1"># User constraint: &quot;if user manually edits... handle gracefully&quot;.</span>
                <span class="c1"># Let&#39;s log/ignore and continue, effectively stripping bad metadata lines from table data.</span>
                <span class="k">continue</span>

        <span class="n">parsed_row</span> <span class="o">=</span> <span class="n">parse_row</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">parsed_row</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">potential_header</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">detected_alignments</span> <span class="o">=</span> <span class="n">parse_separator_row</span><span class="p">(</span><span class="n">parsed_row</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">detected_alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">headers</span> <span class="o">=</span> <span class="n">potential_header</span>
                <span class="n">alignments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">detected_alignments</span>
                <span class="n">potential_header</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">continue</span>
                <span class="n">potential_header</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Previous row was not a header, treat as data</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">potential_header</span><span class="p">)</span>
                <span class="n">potential_header</span> <span class="o">=</span> <span class="n">parsed_row</span>
        <span class="k">elif</span> <span class="n">headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">potential_header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">potential_header</span> <span class="o">=</span> <span class="n">parsed_row</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parsed_row</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">potential_header</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">potential_header</span><span class="p">)</span>

    <span class="c1"># Normalize rows to match header length</span>
    <span class="k">if</span> <span class="n">headers</span><span class="p">:</span>
        <span class="n">header_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">normalized_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">header_len</span><span class="p">:</span>
                <span class="c1"># Pad with empty strings</span>
                <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">header_len</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)))</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">header_len</span><span class="p">:</span>
                <span class="c1"># Truncate</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">row</span><span class="p">[:</span><span class="n">header_len</span><span class="p">]</span>
            <span class="n">normalized_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">normalized_rows</span>

    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;schema_used&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">schema</span><span class="p">)}</span>
    <span class="k">if</span> <span class="n">visual_metadata</span><span class="p">:</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;visual&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">visual_metadata</span>

    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">alignments</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.parse_table_from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_table_from_file</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_SCHEMA</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse a markdown table from a file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>, <span title="typing.TextIO">TextIO</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File path (str/Path) or file-like object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parsing configuration.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_SCHEMA">DEFAULT_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_table_from_file</span><span class="p">(</span>
    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">],</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse a markdown table from a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        source: File path (str/Path) or file-like object.</span>
<span class="sd">        schema: Parsing configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">_read_content</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parse_table</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.parse_workbook" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_workbook</span><span class="p">(</span><span class="n">markdown</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">MultiTableParsingSchema</span><span class="p">())</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse a markdown document into a Workbook.</p>
<p>When schema.root_marker is None, auto-detection is used:
1. If a single H1 header exists, it becomes the Workbook.
2. If md-spreadsheet metadata comment exists, the H1 containing it becomes Workbook.
3. Fallback to searching for "# Tables" or "# Workbook".
4. If not found, return empty Workbook.</p>
<p>When root_marker/sheet_header_level/table_header_level are None,
they are auto-calculated from the detected workbook level.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/parsing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_workbook</span><span class="p">(</span>
    <span class="n">markdown</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span> <span class="o">=</span> <span class="n">MultiTableParsingSchema</span><span class="p">()</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Workbook</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse a markdown document into a Workbook.</span>

<span class="sd">    When schema.root_marker is None, auto-detection is used:</span>
<span class="sd">    1. If a single H1 header exists, it becomes the Workbook.</span>
<span class="sd">    2. If md-spreadsheet metadata comment exists, the H1 containing it becomes Workbook.</span>
<span class="sd">    3. Fallback to searching for &quot;# Tables&quot; or &quot;# Workbook&quot;.</span>
<span class="sd">    4. If not found, return empty Workbook.</span>

<span class="sd">    When root_marker/sheet_header_level/table_header_level are None,</span>
<span class="sd">    they are auto-calculated from the detected workbook level.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">frontmatter_text</span><span class="p">,</span> <span class="n">remaining_markdown</span> <span class="o">=</span> <span class="n">extract_frontmatter</span><span class="p">(</span><span class="n">markdown</span><span class="p">)</span>
    <span class="n">frontmatter_metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">frontmatter_text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">frontmatter_metadata</span> <span class="o">=</span> <span class="n">parse_yaml_frontmatter</span><span class="p">(</span><span class="n">frontmatter_text</span><span class="p">)</span>

    <span class="c1"># If the frontmatter does not have a title, it does not constitute a Workbook,</span>
    <span class="c1"># and its metadata should not be implicitly merged into subsequent Workbooks.</span>
    <span class="k">if</span> <span class="s2">&quot;title&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">frontmatter_metadata</span><span class="p">:</span>
        <span class="n">frontmatter_metadata</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">remaining_markdown</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">sheets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Sheet</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Check for Workbook metadata at the end of the file</span>
    <span class="c1"># Scan for Workbook metadata anywhere in the file</span>
    <span class="c1"># We filter it out from the lines so it doesn&#39;t interfere with sheet content</span>
    <span class="n">filtered_lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">wb_metadata_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;^&lt;!-- md-spreadsheet-workbook-metadata: (.*) --&gt;$&quot;</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">stripped</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">wb_metadata_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">stripped</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">metadata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="c1"># Skip adding this line to filtered_lines</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filtered_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">filtered_lines</span>

    <span class="c1"># Determine root marker and header levels</span>
    <span class="n">root_marker</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">root_marker</span>
    <span class="n">workbook_name</span> <span class="o">=</span> <span class="s2">&quot;Workbook&quot;</span>
    <span class="n">workbook_level</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Default H1</span>

    <span class="n">virtual_root</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">root_marker</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;title&quot;</span> <span class="ow">in</span> <span class="n">frontmatter_metadata</span><span class="p">:</span>
        <span class="n">title_val</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">frontmatter_metadata</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">title_val</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_has_h1_headers</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="c1"># No actual H1 headers → frontmatter title is the workbook root</span>
            <span class="n">root_marker</span> <span class="o">=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="n">title_val</span>
            <span class="n">workbook_name</span> <span class="o">=</span> <span class="n">title_val</span>
            <span class="n">workbook_level</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">virtual_root</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># else: H1 exists → frontmatter is a Document section,</span>
        <span class="c1"># let normal auto-detection (below) handle workbook selection</span>

    <span class="c1"># Isolate frontmatter in sub-dict for round-trip fidelity</span>
    <span class="c1"># Only when frontmatter IS the workbook root (virtual_root)</span>
    <span class="k">if</span> <span class="n">virtual_root</span> <span class="ow">and</span> <span class="n">frontmatter_metadata</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;header_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;frontmatter&quot;</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;frontmatter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frontmatter_metadata</span>

    <span class="k">if</span> <span class="n">root_marker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Auto-detection mode</span>
        <span class="c1"># Find all H1 headers (not in code blocks)</span>
        <span class="n">h1_headers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># (line_index, header_text)</span>
        <span class="n">in_code_block</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="n">stripped</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;```&quot;</span><span class="p">):</span>
                <span class="n">in_code_block</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">in_code_block</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">in_code_block</span>
                <span class="ow">and</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;# &quot;</span><span class="p">)</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;## &quot;</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="c1"># This is an H1 header (starts with &quot;# &quot; but not &quot;## &quot;)</span>
                <span class="n">header_text</span> <span class="o">=</span> <span class="n">stripped</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">h1_headers</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">header_text</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h1_headers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Single H1: use it as workbook</span>
            <span class="n">root_marker</span> <span class="o">=</span> <span class="n">h1_headers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">workbook_name</span> <span class="o">=</span> <span class="n">root_marker</span>
            <span class="n">root_marker</span> <span class="o">=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="n">root_marker</span>
            <span class="n">workbook_level</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">h1_headers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Step 3: If md-spreadsheet metadata exists, find the H1 that contains it</span>
            <span class="c1"># The metadata comment should be inside a section, so we find the H1</span>
            <span class="c1"># header that precedes the metadata comment location.</span>
            <span class="c1"># Since we already extracted metadata, we need to find which H1 section</span>
            <span class="c1"># contains it by re-scanning the original lines.</span>

            <span class="c1"># Re-scan original lines to find metadata line index</span>
            <span class="n">original_lines</span> <span class="o">=</span> <span class="n">markdown</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">metadata_line_idx</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">original_lines</span><span class="p">):</span>
                <span class="n">stripped</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">wb_metadata_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">stripped</span><span class="p">):</span>
                    <span class="n">metadata_line_idx</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">metadata_line_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Find the H1 header that precedes this metadata line</span>
                <span class="c1"># Map original line indices to filtered line indices</span>
                <span class="n">selected_h1</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">line_idx</span><span class="p">,</span> <span class="n">header_text</span> <span class="ow">in</span> <span class="n">h1_headers</span><span class="p">:</span>
                    <span class="c1"># h1_headers contains indices in filtered_lines</span>
                    <span class="c1"># Need to find corresponding original index</span>
                    <span class="c1"># Actually, h1_headers was built from filtered_lines (after metadata removal)</span>
                    <span class="c1"># So we need to re-scan original to find H1 before metadata</span>
                    <span class="k">pass</span>

                <span class="c1"># Simpler approach: scan original lines for H1 headers before metadata</span>
                <span class="n">in_code_block</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">metadata_line_idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">stripped</span> <span class="o">=</span> <span class="n">original_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;```&quot;</span><span class="p">):</span>
                        <span class="n">in_code_block</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">in_code_block</span>
                    <span class="k">elif</span> <span class="p">(</span>
                        <span class="ow">not</span> <span class="n">in_code_block</span>
                        <span class="ow">and</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;# &quot;</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="ow">not</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;## &quot;</span><span class="p">)</span>
                    <span class="p">):</span>
                        <span class="c1"># Found the H1 header that contains the metadata</span>
                        <span class="n">header_text</span> <span class="o">=</span> <span class="n">stripped</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="n">root_marker</span> <span class="o">=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="n">header_text</span>
                        <span class="n">workbook_name</span> <span class="o">=</span> <span class="n">header_text</span>
                        <span class="n">workbook_level</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="n">selected_h1</span> <span class="o">=</span> <span class="n">header_text</span>
                        <span class="k">break</span>

                <span class="k">if</span> <span class="n">selected_h1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Metadata exists but no H1 before it - use first H1</span>
                    <span class="k">if</span> <span class="n">h1_headers</span><span class="p">:</span>
                        <span class="n">root_marker</span> <span class="o">=</span> <span class="n">h1_headers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">workbook_name</span> <span class="o">=</span> <span class="n">root_marker</span>
                        <span class="n">root_marker</span> <span class="o">=</span> <span class="s2">&quot;# &quot;</span> <span class="o">+</span> <span class="n">root_marker</span>
                        <span class="n">workbook_level</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Shouldn&#39;t happen since metadata was found</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="n">root_marker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Multiple or no H1: fallback to &quot;# Tables&quot; or &quot;# Workbook&quot;</span>
            <span class="n">in_code_block</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                <span class="n">stripped</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;```&quot;</span><span class="p">):</span>
                    <span class="n">in_code_block</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">in_code_block</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">in_code_block</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">stripped</span> <span class="o">==</span> <span class="s2">&quot;# Tables&quot;</span><span class="p">:</span>
                        <span class="n">root_marker</span> <span class="o">=</span> <span class="s2">&quot;# Tables&quot;</span>
                        <span class="n">workbook_name</span> <span class="o">=</span> <span class="s2">&quot;Tables&quot;</span>
                        <span class="n">workbook_level</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">break</span>
                    <span class="k">elif</span> <span class="n">stripped</span> <span class="o">==</span> <span class="s2">&quot;# Workbook&quot;</span><span class="p">:</span>
                        <span class="n">root_marker</span> <span class="o">=</span> <span class="s2">&quot;# Workbook&quot;</span>
                        <span class="n">workbook_name</span> <span class="o">=</span> <span class="s2">&quot;Workbook&quot;</span>
                        <span class="n">workbook_level</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">break</span>
            <span class="k">if</span> <span class="n">root_marker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># No workbook found</span>
                <span class="k">return</span> <span class="n">Workbook</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[],</span> <span class="n">name</span><span class="o">=</span><span class="n">workbook_name</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Explicit root_marker: extract name and level from it</span>
        <span class="k">if</span> <span class="n">root_marker</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
            <span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">root_marker</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&quot;#&quot;</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="n">workbook_level</span> <span class="o">=</span> <span class="n">level</span>
            <span class="n">workbook_name</span> <span class="o">=</span> <span class="n">root_marker</span><span class="p">[</span><span class="n">level</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="c1"># Calculate header levels if not explicitly set</span>
    <span class="c1"># Only auto-calculate from workbook_level if root_marker was auto-detected</span>
    <span class="c1"># When root_marker is explicit, honor the explicit None values (meaning &quot;no headers&quot;)</span>
    <span class="n">root_marker_auto_detected</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">root_marker</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">sheet_header_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sheet_header_level</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">sheet_header_level</span>
    <span class="k">elif</span> <span class="n">root_marker_auto_detected</span><span class="p">:</span>
        <span class="n">sheet_header_level</span> <span class="o">=</span> <span class="n">workbook_level</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Explicit root_marker but no sheet_header_level: default to 2</span>
        <span class="n">sheet_header_level</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">table_header_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">table_header_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">table_header_level</span>
    <span class="k">elif</span> <span class="n">root_marker_auto_detected</span><span class="p">:</span>
        <span class="n">table_header_level</span> <span class="o">=</span> <span class="n">workbook_level</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Explicit root_marker but no table_header_level: keep as None (no table headers)</span>
        <span class="n">table_header_level</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Create an effective schema with resolved values</span>
    <span class="n">effective_schema</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span>
        <span class="n">schema</span><span class="p">,</span>
        <span class="n">root_marker</span><span class="o">=</span><span class="n">root_marker</span><span class="p">,</span>
        <span class="n">sheet_header_level</span><span class="o">=</span><span class="n">sheet_header_level</span><span class="p">,</span>
        <span class="n">table_header_level</span><span class="o">=</span><span class="n">table_header_level</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Find root marker</span>
    <span class="n">start_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">workbook_start_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">in_code_block</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">virtual_root</span><span class="p">:</span>
        <span class="n">start_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">workbook_start_line</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="n">stripped</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;```&quot;</span><span class="p">):</span>
                <span class="n">in_code_block</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">in_code_block</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">in_code_block</span> <span class="ow">and</span> <span class="n">stripped</span> <span class="o">==</span> <span class="n">root_marker</span><span class="p">:</span>
                <span class="n">start_index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">workbook_start_line</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Workbook</span><span class="p">(</span><span class="n">sheets</span><span class="o">=</span><span class="p">[],</span> <span class="n">name</span><span class="o">=</span><span class="n">workbook_name</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>

    <span class="c1"># Split by sheet headers</span>
    <span class="n">header_prefix</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="n">sheet_header_level</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>

    <span class="n">current_sheet_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">current_sheet_lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_sheet_start_line</span> <span class="o">=</span> <span class="n">start_index</span>

    <span class="c1"># Reset code block state for the second pass</span>
    <span class="c1"># If we started after a root marker, check if that root marker line was just a marker.</span>
    <span class="c1"># We assume valid markdown structure where root marker is not inside a code block (handled above).</span>
    <span class="n">in_code_block</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Capture root content (text between workbook header and first sheet header)</span>
    <span class="n">root_content_lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Track workbook section end line</span>
    <span class="c1"># If loop breaks due to another H1, end is line before that H1</span>
    <span class="c1"># Otherwise end is the last line of the file</span>
    <span class="n">workbook_end_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">start_index</span><span class="p">:],</span> <span class="n">start</span><span class="o">=</span><span class="n">start_index</span><span class="p">):</span>
        <span class="n">stripped</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;```&quot;</span><span class="p">):</span>
            <span class="n">in_code_block</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">in_code_block</span>

        <span class="k">if</span> <span class="n">in_code_block</span><span class="p">:</span>
            <span class="c1"># Just collect lines if we are in a sheet or root content</span>
            <span class="k">if</span> <span class="n">current_sheet_name</span><span class="p">:</span>
                <span class="n">current_sheet_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">root_content_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">workbook_end_line</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># Track last line in section</span>
            <span class="k">continue</span>

        <span class="c1"># Check if line is a header</span>
        <span class="k">if</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
            <span class="c1"># Count header level</span>
            <span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">stripped</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&quot;#&quot;</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="c1"># If header level is less than sheet_header_level (e.g. # vs ##),</span>
            <span class="c1"># it indicates a higher-level section, so we stop parsing the workbook.</span>
            <span class="k">if</span> <span class="n">level</span> <span class="o">&lt;</span> <span class="n">sheet_header_level</span><span class="p">:</span>
                <span class="c1"># workbook_end_line is already set to last processed line</span>
                <span class="k">break</span>

            <span class="c1"># If header match sheet_header_level, it&#39;s a new sheet</span>
            <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="n">sheet_header_level</span> <span class="ow">and</span> <span class="n">stripped</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">header_prefix</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">current_sheet_name</span><span class="p">:</span>
                    <span class="n">sheet_content</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_sheet_lines</span><span class="p">)</span>
                    <span class="n">sheets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">parse_sheet</span><span class="p">(</span>
                            <span class="n">sheet_content</span><span class="p">,</span>
                            <span class="n">current_sheet_name</span><span class="p">,</span>
                            <span class="n">effective_schema</span><span class="p">,</span>
                            <span class="n">start_line_offset</span><span class="o">=</span><span class="n">current_sheet_start_line</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

                <span class="n">current_sheet_name</span> <span class="o">=</span> <span class="n">stripped</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">header_prefix</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">current_sheet_lines</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">current_sheet_start_line</span> <span class="o">=</span> <span class="n">idx</span>
                <span class="n">workbook_end_line</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">continue</span>

        <span class="c1"># Not a sheet header</span>
        <span class="k">if</span> <span class="n">current_sheet_name</span><span class="p">:</span>
            <span class="n">current_sheet_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># We are in root content area (between Workbook header and first Sheet)</span>
            <span class="n">root_content_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="n">workbook_end_line</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># Track last line processed (exclusive end)</span>

    <span class="k">if</span> <span class="n">current_sheet_name</span><span class="p">:</span>
        <span class="n">sheet_content</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_sheet_lines</span><span class="p">)</span>
        <span class="n">sheets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">parse_sheet</span><span class="p">(</span>
                <span class="n">sheet_content</span><span class="p">,</span>
                <span class="n">current_sheet_name</span><span class="p">,</span>
                <span class="n">effective_schema</span><span class="p">,</span>
                <span class="n">start_line_offset</span><span class="o">=</span><span class="n">current_sheet_start_line</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># If no lines were processed, end_line is start_line + 1</span>
    <span class="k">if</span> <span class="n">workbook_end_line</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">workbook_end_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">workbook_start_line</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">workbook_start_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

    <span class="n">root_content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">root_content_lines</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_content_lines</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="n">root_content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">Workbook</span><span class="p">(</span>
        <span class="n">sheets</span><span class="o">=</span><span class="n">sheets</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">workbook_name</span><span class="p">,</span>
        <span class="n">start_line</span><span class="o">=</span><span class="n">workbook_start_line</span><span class="p">,</span>
        <span class="n">end_line</span><span class="o">=</span><span class="n">workbook_end_line</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">root_content</span><span class="o">=</span><span class="n">root_content</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.parse_workbook_from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_workbook_from_file</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">MultiTableParsingSchema</span><span class="p">())</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse a markdown workbook from a file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>, <span title="typing.TextIO">TextIO</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File path (str/Path) or file-like object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MultiTableParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.MultiTableParsingSchema)" href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema">MultiTableParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parsing configuration.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MultiTableParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.MultiTableParsingSchema)" href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema">MultiTableParsingSchema</a>()</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_workbook_from_file</span><span class="p">(</span>
    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">],</span>
    <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span> <span class="o">=</span> <span class="n">MultiTableParsingSchema</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Workbook</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse a markdown workbook from a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        source: File path (str/Path) or file-like object.</span>
<span class="sd">        schema: Parsing configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">_read_content</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parse_workbook</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.scan_tables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scan_tables</span><span class="p">(</span><span class="n">markdown</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Scan a markdown document for all tables, ignoring sheet structure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>markdown</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The markdown text.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MultiTableParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.MultiTableParsingSchema)" href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema">MultiTableParsingSchema</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional schema. If None, uses default MultiTableParsingSchema.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/parsing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scan_tables</span><span class="p">(</span>
    <span class="n">markdown</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scan a markdown document for all tables, ignoring sheet structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        markdown: The markdown text.</span>
<span class="sd">        schema: Optional schema. If None, uses default MultiTableParsingSchema.</span>

<span class="sd">    Returns:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">schema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">MultiTableParsingSchema</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">_extract_tables</span><span class="p">(</span><span class="n">markdown</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.scan_tables_from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scan_tables_from_file</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Scan a markdown file for all tables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>, <span title="typing.TextIO">TextIO</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File path (str/Path) or file-like object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MultiTableParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.MultiTableParsingSchema)" href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema">MultiTableParsingSchema</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional schema.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scan_tables_from_file</span><span class="p">(</span>
    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">],</span> <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scan a markdown file for all tables.</span>

<span class="sd">    Args:</span>
<span class="sd">        source: File path (str/Path) or file-like object.</span>
<span class="sd">        schema: Optional schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">_read_content</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scan_tables</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.scan_tables_iter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scan_tables_iter</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stream tables from a source (file path, file object, or iterable) one by one.
This allows processing files larger than memory, provided that individual tables fit in memory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>, <span title="typing.TextIO">TextIO</span>, <span title="typing.Iterable">Iterable</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File path, open file object, or iterable of strings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MultiTableParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.MultiTableParsingSchema)" href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema">MultiTableParsingSchema</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parsing configuration.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table objects found in the stream.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scan_tables_iter</span><span class="p">(</span>
    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Table</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stream tables from a source (file path, file object, or iterable) one by one.</span>
<span class="sd">    This allows processing files larger than memory, provided that individual tables fit in memory.</span>

<span class="sd">    Args:</span>
<span class="sd">        source: File path, open file object, or iterable of strings.</span>
<span class="sd">        schema: Parsing configuration.</span>

<span class="sd">    Yields:</span>
<span class="sd">        Table objects found in the stream.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">schema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">MultiTableParsingSchema</span><span class="p">()</span>

    <span class="n">header_prefix</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">table_header_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">header_prefix</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">*</span> <span class="n">schema</span><span class="o">.</span><span class="n">table_header_level</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>

    <span class="n">current_lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># We track line number manually for metadata</span>
    <span class="n">current_line_idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Start of the current block</span>
    <span class="n">block_start_line</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_and_yield</span><span class="p">(</span>
        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Table</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Check if block looks like a table (has separator)</span>
        <span class="n">block_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">block_text</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Simple extraction logic similar to process_table_block</span>
        <span class="c1"># We reuse parsing logic.</span>

        <span class="c1"># Split description vs table</span>
        <span class="c1"># We need list of lines stripped of newline for index finding</span>
        <span class="n">stripped_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line_val</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">line_val</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>

        <span class="n">table_start_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stripped_lines</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">table_start_idx</span> <span class="o">=</span> <span class="n">idx</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">table_start_idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">desc_lines</span> <span class="o">=</span> <span class="n">stripped_lines</span><span class="p">[:</span><span class="n">table_start_idx</span><span class="p">]</span>
            <span class="n">table_lines</span> <span class="o">=</span> <span class="n">stripped_lines</span><span class="p">[</span><span class="n">table_start_idx</span><span class="p">:]</span>

            <span class="n">table_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">table_lines</span><span class="p">)</span>
            <span class="n">table</span> <span class="o">=</span> <span class="n">parse_table</span><span class="p">(</span><span class="n">table_text</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">rows</span> <span class="ow">or</span> <span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
                <span class="n">description</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">capture_description</span><span class="p">:</span>
                    <span class="n">desc_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">desc_lines</span> <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">desc_text</span><span class="p">:</span>
                        <span class="n">description</span> <span class="o">=</span> <span class="n">desc_text</span>

                <span class="n">table</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span>
                    <span class="n">table</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                    <span class="n">start_line</span><span class="o">=</span><span class="n">start_offset</span> <span class="o">+</span> <span class="n">table_start_idx</span><span class="p">,</span>
                    <span class="n">end_line</span><span class="o">=</span><span class="n">start_offset</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">yield</span> <span class="n">table</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">_iter_lines</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
        <span class="c1"># normalize: file iter yields line with \n</span>
        <span class="n">stripped_line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="n">is_header</span> <span class="o">=</span> <span class="n">header_prefix</span> <span class="ow">and</span> <span class="n">stripped_line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">header_prefix</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_header</span><span class="p">:</span>
            <span class="c1"># New section starts. Yield previous buffer if any.</span>
            <span class="k">yield from</span> <span class="n">parse_and_yield</span><span class="p">(</span><span class="n">current_lines</span><span class="p">,</span> <span class="n">current_name</span><span class="p">,</span> <span class="n">block_start_line</span><span class="p">)</span>

            <span class="k">assert</span> <span class="n">header_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">current_name</span> <span class="o">=</span> <span class="n">stripped_line</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">header_prefix</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">current_lines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">block_start_line</span> <span class="o">=</span> <span class="n">current_line_idx</span>

        <span class="k">elif</span> <span class="n">stripped_line</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="c1"># Blank line.</span>
            <span class="k">yield from</span> <span class="n">parse_and_yield</span><span class="p">(</span><span class="n">current_lines</span><span class="p">,</span> <span class="n">current_name</span><span class="p">,</span> <span class="n">block_start_line</span><span class="p">)</span>
            <span class="n">current_lines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># block_start_line for NEXT block will be current_line_idx + 1</span>
            <span class="n">block_start_line</span> <span class="o">=</span> <span class="n">current_line_idx</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="n">current_line_idx</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># End of stream</span>
    <span class="k">yield from</span> <span class="n">parse_and_yield</span><span class="p">(</span><span class="n">current_lines</span><span class="p">,</span> <span class="n">current_name</span><span class="p">,</span> <span class="n">block_start_line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="md_spreadsheet_parser.schemas" class="doc doc-heading">
            <code>md_spreadsheet_parser.schemas</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.schemas.ConversionSchema" class="doc doc-heading">
            <code>ConversionSchema</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Configuration for converting string values to Python types.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ConversionSchema.boolean_pairs">boolean_pairs</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>], ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pairs of strings representing (True, False). Case-insensitive.
           Example: <code>(("yes", "no"), ("on", "off"))</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ConversionSchema.custom_converters">custom_converters</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="type">type</span>, <span title="typing.Callable">Callable</span>[[<span title="str">str</span>], <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping ANY Python type to a conversion function <code>str -&gt; Any</code>.
               You can specify:
               - Built-in types: <code>int</code>, <code>float</code>, <code>bool</code> (to override default behavior)
               - Standard library types: <code>Decimal</code>, <code>datetime</code>, <code>date</code>, <code>ZoneInfo</code>
               - Custom classes: <code>MyClass</code>, <code>Product</code></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ConversionSchema.field_converters">field_converters</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Callable">Callable</span>[[<span title="str">str</span>], <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping field names (str) to conversion functions.
              Takes precedence over <code>custom_converters</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/schemas.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConversionSchema</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for converting string values to Python types.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        boolean_pairs: Pairs of strings representing (True, False). Case-insensitive.</span>
<span class="sd">                       Example: `((&quot;yes&quot;, &quot;no&quot;), (&quot;on&quot;, &quot;off&quot;))`.</span>
<span class="sd">        custom_converters: Dictionary mapping ANY Python type to a conversion function `str -&gt; Any`.</span>
<span class="sd">                           You can specify:</span>
<span class="sd">                           - Built-in types: `int`, `float`, `bool` (to override default behavior)</span>
<span class="sd">                           - Standard library types: `Decimal`, `datetime`, `date`, `ZoneInfo`</span>
<span class="sd">                           - Custom classes: `MyClass`, `Product`</span>
<span class="sd">        field_converters: Dictionary mapping field names (str) to conversion functions.</span>
<span class="sd">                          Takes precedence over `custom_converters`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">boolean_pairs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;[x]&quot;</span><span class="p">,</span> <span class="s2">&quot;[ ]&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">custom_converters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">field_converters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.schemas.ExcelParsingSchema" class="doc doc-heading">
            <code>ExcelParsingSchema</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Configuration for parsing Excel-exported data (TSV/CSV or openpyxl).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ExcelParsingSchema.header_rows">header_rows</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of header rows (1 or 2).
         If 2, headers are flattened to "Parent - Child" format.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ExcelParsingSchema.fill_merged_headers">fill_merged_headers</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to forward-fill empty header cells
                 (for merged cells in Excel exports).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ExcelParsingSchema.delimiter">delimiter</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column separator for TSV/CSV parsing. Default is tab.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ExcelParsingSchema.header_separator">header_separator</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Separator used when flattening 2-row headers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/schemas.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExcelParsingSchema</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for parsing Excel-exported data (TSV/CSV or openpyxl).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        header_rows: Number of header rows (1 or 2).</span>
<span class="sd">                     If 2, headers are flattened to &quot;Parent - Child&quot; format.</span>
<span class="sd">        fill_merged_headers: Whether to forward-fill empty header cells</span>
<span class="sd">                             (for merged cells in Excel exports).</span>
<span class="sd">        delimiter: Column separator for TSV/CSV parsing. Default is tab.</span>
<span class="sd">        header_separator: Separator used when flattening 2-row headers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">header_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">fill_merged_headers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
    <span class="n">header_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; - &quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_rows</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;header_rows must be 1 or 2&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.schemas.MultiTableParsingSchema" class="doc doc-heading">
            <code>MultiTableParsingSchema</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code></p>



        <p>Configuration for parsing multiple tables (workbook mode).
Inherits from ParsingSchema.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.MultiTableParsingSchema.root_marker">root_marker</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The marker indicating the start of the data section.
If None, auto-detection is used: single H1 → Workbook, or fallback to
"# Tables" / "# Workbook". Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.MultiTableParsingSchema.sheet_header_level">sheet_header_level</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The markdown header level for sheets.
If None, derived from workbook_level + 1. Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.MultiTableParsingSchema.table_header_level">table_header_level</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The markdown header level for tables.
If None, derived from workbook_level + 2. Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.MultiTableParsingSchema.capture_description">capture_description</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to capture text between the table header
and the table as a description. Defaults to True.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/schemas.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MultiTableParsingSchema</span><span class="p">(</span><span class="n">ParsingSchema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for parsing multiple tables (workbook mode).</span>
<span class="sd">    Inherits from ParsingSchema.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        root_marker (str | None): The marker indicating the start of the data section.</span>
<span class="sd">            If None, auto-detection is used: single H1 → Workbook, or fallback to</span>
<span class="sd">            &quot;# Tables&quot; / &quot;# Workbook&quot;. Defaults to None.</span>
<span class="sd">        sheet_header_level (int | None): The markdown header level for sheets.</span>
<span class="sd">            If None, derived from workbook_level + 1. Defaults to None.</span>
<span class="sd">        table_header_level (int | None): The markdown header level for tables.</span>
<span class="sd">            If None, derived from workbook_level + 2. Defaults to None.</span>
<span class="sd">        capture_description (bool): Whether to capture text between the table header</span>
<span class="sd">            and the table as a description. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">root_marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">sheet_header_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">table_header_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">capture_description</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Handle ParsingSchema defaults manually since they are separate fields in instance</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_separator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;column_separator&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_separator_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;header_separator_char&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_outer_pipes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;require_outer_pipes&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip_whitespace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;strip_whitespace&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_br_to_newline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;convert_br_to_newline&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># root_marker, sheet_header_level, table_header_level can all be None</span>
        <span class="c1"># (auto-detection is handled in parsing.py)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture_description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;capture_description&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.schemas.ParsingSchema" class="doc doc-heading">
            <code>ParsingSchema</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Configuration for parsing markdown tables.
Designed to be immutable and passed to pure functions.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ParsingSchema.column_separator">column_separator</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Character used to separate columns. Defaults to "|".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ParsingSchema.header_separator_char">header_separator_char</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Character used in the separator row. Defaults to "-".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ParsingSchema.require_outer_pipes">require_outer_pipes</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether tables must have outer pipes (e.g. <code>| col |</code>). Defaults to True.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.schemas.ParsingSchema.strip_whitespace">strip_whitespace</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to strip whitespace from cell values. Defaults to True.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/schemas.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ParsingSchema</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for parsing markdown tables.</span>
<span class="sd">    Designed to be immutable and passed to pure functions.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        column_separator (str): Character used to separate columns. Defaults to &quot;|&quot;.</span>
<span class="sd">        header_separator_char (str): Character used in the separator row. Defaults to &quot;-&quot;.</span>
<span class="sd">        require_outer_pipes (bool): Whether tables must have outer pipes (e.g. `| col |`). Defaults to True.</span>
<span class="sd">        strip_whitespace (bool): Whether to strip whitespace from cell values. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">column_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span>
    <span class="n">header_separator_char</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
    <span class="n">require_outer_pipes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">strip_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">convert_br_to_newline</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Ensure defaults if None is passed (e.g. from WASM)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_separator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;column_separator&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_separator_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;header_separator_char&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_outer_pipes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;require_outer_pipes&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip_whitespace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;strip_whitespace&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_br_to_newline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;convert_br_to_newline&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="md_spreadsheet_parser.models" class="doc doc-heading">
            <code>md_spreadsheet_parser.models</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.models.Sheet" class="doc doc-heading">
            <code>Sheet</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Represents a single sheet containing tables.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Sheet.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the sheet.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Sheet.tables">tables</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tables contained in this sheet.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Sheet.sheet_type">sheet_type</span></code></td>
            <td>
                  <code><span title="md_spreadsheet_parser.models.SheetType">SheetType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of sheet - "table" for table sheet, "doc" for document sheet.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Sheet.content">content</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw markdown content for doc sheets. Only set when sheet_type="doc".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Sheet.metadata">metadata</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Arbitrary metadata (e.g. layout). Defaults to None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Sheet</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a single sheet containing tables.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name (str): Name of the sheet.</span>
<span class="sd">        tables (list[Table]): List of tables contained in this sheet.</span>
<span class="sd">        sheet_type (SheetType): Type of sheet - &quot;table&quot; for table sheet, &quot;doc&quot; for document sheet.</span>
<span class="sd">        content (str | None): Raw markdown content for doc sheets. Only set when sheet_type=&quot;doc&quot;.</span>
<span class="sd">        metadata (dict[str, Any] | None): Arbitrary metadata (e.g. layout). Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">tables</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">]</span>
    <span class="n">sheet_type</span><span class="p">:</span> <span class="n">SheetType</span> <span class="o">=</span> <span class="s2">&quot;table&quot;</span>
    <span class="n">content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Hack to allow default value for mutable type in frozen dataclass</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SheetJSON</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a JSON-compatible dictionary representation of the sheet.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SheetJSON: A dictionary containing the sheet data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;sheet_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheet_type</span><span class="p">,</span>
            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
            <span class="s2">&quot;tables&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">json</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">],</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{},</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve a table by its name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the table to retrieve.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Table | None: The table object if found, otherwise None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">table</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a Markdown string representation of the sheet.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The Markdown string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">generate_sheet_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Sheet with the name changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Sheet with a new empty table appended.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
        <span class="n">new_tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_table</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Sheet with the table at index removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Table index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
        <span class="n">new_tables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">replace_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="s2">&quot;Table&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Sheet with the table at index replaced.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Table index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
        <span class="n">new_tables</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Sheet with the table moved from from_index to to_index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">new_tables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
        <span class="n">new_tables</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="md_spreadsheet_parser.models.Sheet.json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns a JSON-compatible dictionary representation of the sheet.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>SheetJSON</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="SheetJSON (md_spreadsheet_parser.models.SheetJSON)" href="#md_spreadsheet_parser.models.SheetJSON">SheetJSON</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the sheet data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Sheet.add_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_table</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Sheet with a new empty table appended.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Sheet with a new empty table appended.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
    <span class="n">new_tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_table</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Sheet.delete_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_table</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Sheet with the table at index removed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Sheet with the table at index removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Table index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
    <span class="n">new_tables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Sheet.get_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_table</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieve a table by its name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table | None: The table object if found, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve a table by its name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): The name of the table to retrieve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table | None: The table object if found, otherwise None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">table</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Sheet.move_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_table</span><span class="p">(</span><span class="n">from_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Sheet with the table moved from from_index to to_index.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Sheet with the table moved from from_index to to_index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">new_tables</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
    <span class="n">new_tables</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Sheet.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Sheet with the name changed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Sheet with the name changed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Sheet.replace_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">replace_table</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Sheet with the table at index replaced.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">replace_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="s2">&quot;Table&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Sheet with the table at index replaced.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Table index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span>
    <span class="n">new_tables</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="n">new_tables</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Sheet.to_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_markdown</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_SCHEMA</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the sheet.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_SCHEMA">DEFAULT_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the sheet.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">generate_sheet_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.models.SheetJSON" class="doc doc-heading">
            <code>SheetJSON</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>



        <p>JSON-compatible dictionary representation of a Sheet.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SheetJSON</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    JSON-compatible dictionary representation of a Sheet.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">sheet_type</span><span class="p">:</span> <span class="n">SheetType</span>
    <span class="n">content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">tables</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TableJSON</span><span class="p">]</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.models.Table" class="doc doc-heading">
            <code>Table</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Represents a parsed table with optional metadata.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Table.headers">headers</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column headers, or None if the table has no headers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Table.rows">rows</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of data rows.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Table.alignments">alignments</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="md_spreadsheet_parser.models.AlignmentType">AlignmentType</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column alignments ('left', 'center', 'right'). Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Table.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the table (e.g. from a header). Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Table.description">description</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of the table. Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Table.metadata">metadata</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Arbitrary metadata. Defaults to None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a parsed table with optional metadata.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        headers (list[str] | None): List of column headers, or None if the table has no headers.</span>
<span class="sd">        rows (list[list[str]]): List of data rows.</span>
<span class="sd">        alignments (list[AlignmentType] | None): List of column alignments (&#39;left&#39;, &#39;center&#39;, &#39;right&#39;). Defaults to None.</span>
<span class="sd">        name (str | None): Name of the table (e.g. from a header). Defaults to None.</span>
<span class="sd">        description (str | None): Description of the table. Defaults to None.</span>
<span class="sd">        metadata (dict[str, Any] | None): Arbitrary metadata. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">headers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">rows</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="n">alignments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">start_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">end_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Hack to allow default value for mutable type in frozen dataclass</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TableJSON</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a JSON-compatible dictionary representation of the table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            TableJSON: A dictionary containing the table data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
            <span class="s2">&quot;rows&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{},</span>
            <span class="s2">&quot;start_line&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span><span class="p">,</span>
            <span class="s2">&quot;end_line&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_line</span><span class="p">,</span>
            <span class="s2">&quot;alignments&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_models</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">schema_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
        <span class="n">conversion_schema</span><span class="p">:</span> <span class="n">ConversionSchema</span> <span class="o">=</span> <span class="n">DEFAULT_CONVERSION_SCHEMA</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the table rows into a list of dataclass instances, performing validation and type conversion.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema_cls (type[T]): The dataclass type to validate against.</span>
<span class="sd">            conversion_schema (ConversionSchema, optional): Configuration for type conversion.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[T]: A list of validated dataclass instances.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If schema_cls is not a dataclass.</span>
<span class="sd">            TableValidationError: If validation fails for any row or if the table has no headers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">validate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema_cls</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a Markdown string representation of the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The Markdown string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">generate_table_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the specified cell updated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Handle header update</span>
        <span class="k">if</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Determine width from rows if possible, or start fresh</span>
                <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="k">else</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">new_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>
                <span class="c1"># Ensure width enough</span>
                <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
                    <span class="n">new_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
                    <span class="n">new_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

            <span class="c1"># Update alignments if headers grew</span>
            <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
                <span class="c1"># Fill with default/None up to new width</span>
                <span class="c1"># But we only need as many alignments as columns.</span>
                <span class="c1"># If alignments is None, it stays None?</span>
                <span class="c1"># Ideally if we start tracking alignments, we should init it?</span>
                <span class="c1"># If self.alignments was None, we might keep it None unless explicitly set?</span>
                <span class="c1"># Consistent behavior: If alignments is NOT None, expand it.</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Cast or explicit type check might be needed for strict type checkers with literals</span>
                    <span class="c1"># Using a typed list to satisfy invariant list[AlignmentType]</span>
                    <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>

            <span class="n">final_alignments</span> <span class="o">=</span> <span class="n">new_alignments</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="n">new_headers</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

            <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">final_alignments</span><span class="p">)</span>

        <span class="c1"># Handle Body update</span>
        <span class="c1"># 1. Ensure row exists</span>
        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>

        <span class="c1"># Grow rows if needed</span>
        <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
            <span class="c1"># Calculate width</span>
            <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
                <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># At least cover the new cell</span>

            <span class="n">rows_to_add</span> <span class="o">=</span> <span class="n">row_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows_to_add</span><span class="p">):</span>
                <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>

        <span class="c1"># If columns expanded due to row update, we might need to expand alignments too</span>
        <span class="n">current_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="n">current_width</span><span class="p">:</span>
            <span class="c1"># This means we are expanding columns</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">width_needed</span> <span class="o">=</span> <span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">current_align_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">width_needed</span> <span class="o">&gt;</span> <span class="n">current_align_len</span><span class="p">:</span>
                    <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
                    <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                        <span class="n">width_needed</span> <span class="o">-</span> <span class="n">current_align_len</span>
                    <span class="p">)</span>
                    <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span>
                        <span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_rows_cell</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
                        <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span><span class="p">,</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_rows_cell</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_rows_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_rows</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">target_row</span> <span class="o">=</span> <span class="n">new_rows</span><span class="p">[</span><span class="n">row_idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_row</span><span class="p">):</span>
            <span class="n">target_row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_row</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">target_row</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">new_rows</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the row at index removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">row_idx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the column at index removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">new_headers</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
            <span class="n">new_headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>

        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
                <span class="n">new_row</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

        <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
                <span class="n">new_alignments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear_column_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with data in the specified column cleared (set to empty string),</span>
<span class="sd">        but headers and column structure preserved.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Headers remain unchanged</span>

        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
                <span class="n">new_row</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">insert_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with an empty row inserted at row_idx.</span>
<span class="sd">        Subsequent rows are shifted down.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>

        <span class="c1"># Determine width</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Default to 1 column if table is empty</span>

        <span class="n">new_row</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>

        <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">row_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
            <span class="n">row_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span>

        <span class="n">new_rows</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">new_row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">insert_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with an empty column inserted at col_idx.</span>
<span class="sd">        Subsequent columns are shifted right.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">new_headers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
                <span class="n">col_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span>
            <span class="n">new_headers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">col_idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
            <span class="c1"># Pad if needed before insertion?</span>
            <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
                <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>
            <span class="n">new_alignments</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">col_idx</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">)</span>  <span class="c1"># Default alignment</span>

        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="c1"># Ensure row is long enough before insertion logic?</span>
            <span class="c1"># Or just insert.</span>
            <span class="c1"># If col_idx is way past end, we might need padding?</span>
            <span class="c1"># Standard list.insert handles index &gt; len -&gt; append.</span>
            <span class="n">current_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>
            <span class="n">target_idx</span> <span class="o">=</span> <span class="n">col_idx</span>
            <span class="k">if</span> <span class="n">target_idx</span> <span class="o">&gt;</span> <span class="n">current_len</span><span class="p">:</span>
                <span class="c1"># Pad up to target</span>
                <span class="n">new_row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">target_idx</span> <span class="o">-</span> <span class="n">current_len</span><span class="p">))</span>
                <span class="n">target_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>  <span class="c1"># Append</span>

            <span class="n">new_row</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">target_idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the name changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the row moved from from_index to to_index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">new_rows</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Table with the column moved from from_index to to_index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Determine width from headers or first row</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
            <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

        <span class="c1"># Move header</span>
        <span class="n">new_headers</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">new_headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
            <span class="n">new_headers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>

        <span class="c1"># Move alignments</span>
        <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">:</span>
            <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
                <span class="n">alignment</span> <span class="o">=</span> <span class="n">new_alignments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
                <span class="n">new_alignments</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span>

        <span class="c1"># Move data in each row</span>
        <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">new_row</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
                <span class="n">new_row</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="md_spreadsheet_parser.models.Table.json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns a JSON-compatible dictionary representation of the table.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>TableJSON</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="TableJSON (md_spreadsheet_parser.models.TableJSON)" href="#md_spreadsheet_parser.models.TableJSON">TableJSON</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the table data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.clear_column_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clear_column_data</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with data in the specified column cleared (set to empty string),
but headers and column structure preserved.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_column_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with data in the specified column cleared (set to empty string),</span>
<span class="sd">    but headers and column structure preserved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Headers remain unchanged</span>

    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
            <span class="n">new_row</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.delete_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_column</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the column at index removed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the column at index removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">new_headers</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
        <span class="n">new_headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>

    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
            <span class="n">new_row</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

    <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
            <span class="n">new_alignments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.delete_row" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_row</span><span class="p">(</span><span class="n">row_idx</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the row at index removed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the row at index removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">row_idx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.insert_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insert_column</span><span class="p">(</span><span class="n">col_idx</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with an empty column inserted at col_idx.
Subsequent columns are shifted right.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">insert_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with an empty column inserted at col_idx.</span>
<span class="sd">    Subsequent columns are shifted right.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">new_headers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">col_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
            <span class="n">col_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span>
        <span class="n">new_headers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">col_idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
        <span class="c1"># Pad if needed before insertion?</span>
        <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
            <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>
        <span class="n">new_alignments</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">col_idx</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">)</span>  <span class="c1"># Default alignment</span>

    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="c1"># Ensure row is long enough before insertion logic?</span>
        <span class="c1"># Or just insert.</span>
        <span class="c1"># If col_idx is way past end, we might need padding?</span>
        <span class="c1"># Standard list.insert handles index &gt; len -&gt; append.</span>
        <span class="n">current_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>
        <span class="n">target_idx</span> <span class="o">=</span> <span class="n">col_idx</span>
        <span class="k">if</span> <span class="n">target_idx</span> <span class="o">&gt;</span> <span class="n">current_len</span><span class="p">:</span>
            <span class="c1"># Pad up to target</span>
            <span class="n">new_row</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">target_idx</span> <span class="o">-</span> <span class="n">current_len</span><span class="p">))</span>
            <span class="n">target_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>  <span class="c1"># Append</span>

        <span class="n">new_row</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">target_idx</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.insert_row" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insert_row</span><span class="p">(</span><span class="n">row_idx</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with an empty row inserted at row_idx.
Subsequent rows are shifted down.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">insert_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with an empty row inserted at row_idx.</span>
<span class="sd">    Subsequent rows are shifted down.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>

    <span class="c1"># Determine width</span>
    <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Default to 1 column if table is empty</span>

    <span class="n">new_row</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>

    <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">row_idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
        <span class="n">row_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span>

    <span class="n">new_rows</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">new_row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.move_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_column</span><span class="p">(</span><span class="n">from_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the column moved from from_index to to_index.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the column moved from from_index to to_index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Determine width from headers or first row</span>
    <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
        <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

    <span class="c1"># Move header</span>
    <span class="n">new_headers</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
        <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">new_headers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
        <span class="n">new_headers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>

    <span class="c1"># Move alignments</span>
    <span class="n">new_alignments</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">:</span>
        <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
            <span class="n">alignment</span> <span class="o">=</span> <span class="n">new_alignments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
            <span class="n">new_alignments</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span>

    <span class="c1"># Move data in each row</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">new_row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_row</span><span class="p">):</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">new_row</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
            <span class="n">new_row</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.move_row" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_row</span><span class="p">(</span><span class="n">from_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the row moved from from_index to to_index.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the row moved from from_index to to_index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">new_rows</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
    <span class="n">new_rows</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the name changed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the name changed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.to_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_markdown</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_SCHEMA</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_SCHEMA">DEFAULT_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">generate_table_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.to_models" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_models</span><span class="p">(</span><span class="n">schema_cls</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="o">=</span><span class="n">DEFAULT_CONVERSION_SCHEMA</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Converts the table rows into a list of dataclass instances, performing validation and type conversion.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema_cls</code>
            </td>
            <td>
                  <code><span title="type">type</span>[<span title="md_spreadsheet_parser.models.T">T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataclass type to validate against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conversion_schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConversionSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ConversionSchema)" href="#md_spreadsheet_parser.schemas.ConversionSchema">ConversionSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for type conversion.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_CONVERSION_SCHEMA">DEFAULT_CONVERSION_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="md_spreadsheet_parser.models.T">T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[T]: A list of validated dataclass instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If schema_cls is not a dataclass.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="TableValidationError (md_spreadsheet_parser.validation.TableValidationError)" href="#md_spreadsheet_parser.validation.TableValidationError">TableValidationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If validation fails for any row or if the table has no headers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_models</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">schema_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
    <span class="n">conversion_schema</span><span class="p">:</span> <span class="n">ConversionSchema</span> <span class="o">=</span> <span class="n">DEFAULT_CONVERSION_SCHEMA</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the table rows into a list of dataclass instances, performing validation and type conversion.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema_cls (type[T]): The dataclass type to validate against.</span>
<span class="sd">        conversion_schema (ConversionSchema, optional): Configuration for type conversion.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[T]: A list of validated dataclass instances.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If schema_cls is not a dataclass.</span>
<span class="sd">        TableValidationError: If validation fails for any row or if the table has no headers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">validate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema_cls</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Table.update_cell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_cell</span><span class="p">(</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Table with the specified cell updated.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Table&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Table with the specified cell updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Handle header update</span>
    <span class="k">if</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Determine width from rows if possible, or start fresh</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="k">else</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">new_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>
            <span class="c1"># Ensure width enough</span>
            <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
                <span class="n">new_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">):</span>
                <span class="n">new_headers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">col_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1"># Update alignments if headers grew</span>
        <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">):</span>
            <span class="c1"># Fill with default/None up to new width</span>
            <span class="c1"># But we only need as many alignments as columns.</span>
            <span class="c1"># If alignments is None, it stays None?</span>
            <span class="c1"># Ideally if we start tracking alignments, we should init it?</span>
            <span class="c1"># If self.alignments was None, we might keep it None unless explicitly set?</span>
            <span class="c1"># Consistent behavior: If alignments is NOT None, expand it.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Cast or explicit type check might be needed for strict type checkers with literals</span>
                <span class="c1"># Using a typed list to satisfy invariant list[AlignmentType]</span>
                <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">new_headers</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_alignments</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>

        <span class="n">final_alignments</span> <span class="o">=</span> <span class="n">new_alignments</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="n">new_headers</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">new_headers</span><span class="p">,</span> <span class="n">alignments</span><span class="o">=</span><span class="n">final_alignments</span><span class="p">)</span>

    <span class="c1"># Handle Body update</span>
    <span class="c1"># 1. Ensure row exists</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">]</span>

    <span class="c1"># Grow rows if needed</span>
    <span class="k">if</span> <span class="n">row_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
        <span class="c1"># Calculate width</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
            <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># At least cover the new cell</span>

        <span class="n">rows_to_add</span> <span class="o">=</span> <span class="n">row_idx</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows_to_add</span><span class="p">):</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>

    <span class="c1"># If columns expanded due to row update, we might need to expand alignments too</span>
    <span class="n">current_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">new_rows</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">col_idx</span> <span class="o">&gt;=</span> <span class="n">current_width</span><span class="p">:</span>
        <span class="c1"># This means we are expanding columns</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">width_needed</span> <span class="o">=</span> <span class="n">col_idx</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">current_align_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">width_needed</span> <span class="o">&gt;</span> <span class="n">current_align_len</span><span class="p">:</span>
                <span class="n">new_alignments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alignments</span><span class="p">)</span>
                <span class="n">extension</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="n">width_needed</span> <span class="o">-</span> <span class="n">current_align_len</span>
                <span class="p">)</span>
                <span class="n">new_alignments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span>
                    <span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_rows_cell</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span>
                    <span class="n">alignments</span><span class="o">=</span><span class="n">new_alignments</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_rows_cell</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.models.TableJSON" class="doc doc-heading">
            <code>TableJSON</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>



        <p>JSON-compatible dictionary representation of a Table.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TableJSON</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    JSON-compatible dictionary representation of a Table.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">headers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">rows</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="n">start_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">end_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">alignments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AlignmentType</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.models.Workbook" class="doc doc-heading">
            <code>Workbook</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">



        <p>Represents a collection of sheets (multi-table output).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Workbook.sheets">sheets</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Sheet


  
      dataclass
   (md_spreadsheet_parser.models.Sheet)" href="#md_spreadsheet_parser.models.Sheet">Sheet</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of sheets in the workbook.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Workbook.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the workbook (extracted from root marker). Defaults to "Workbook".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Workbook.start_line">start_line</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-indexed line number where workbook header starts. None if not detected.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Workbook.end_line">end_line</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0-indexed line number where workbook section ends. None if not detected.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="md_spreadsheet_parser.models.Workbook.metadata">metadata</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Arbitrary metadata. Defaults to None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Workbook</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a collection of sheets (multi-table output).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        sheets (list[Sheet]): List of sheets in the workbook.</span>
<span class="sd">        name (str): Name of the workbook (extracted from root marker). Defaults to &quot;Workbook&quot;.</span>
<span class="sd">        start_line (int | None): 0-indexed line number where workbook header starts. None if not detected.</span>
<span class="sd">        end_line (int | None): 0-indexed line number where workbook section ends. None if not detected.</span>
<span class="sd">        metadata (dict[str, Any] | None): Arbitrary metadata. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sheets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Sheet</span><span class="p">]</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Workbook&quot;</span>
    <span class="n">start_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">end_line</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">root_content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Hack to allow default value for mutable type in frozen dataclass</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WorkbookJSON</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a JSON-compatible dictionary representation of the workbook.</span>

<span class="sd">        Returns:</span>
<span class="sd">            WorkbookJSON: A dictionary containing the workbook data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">WorkbookJSON</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;sheets&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">json</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">],</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{},</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;startLine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;endLine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_line</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;rootContent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_content</span>  <span class="c1"># type: ignore[typeddict-item]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sheet</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve a sheet by its name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the sheet to retrieve.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Sheet | None: The sheet object if found, otherwise None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sheet</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sheet</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_MULTI_TABLE_SCHEMA</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a Markdown string representation of the workbook.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (MultiTableParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The Markdown string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">generate_workbook_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Workbook with a new sheet added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create new sheet with one empty table as default</span>
        <span class="n">new_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]])</span>
        <span class="n">new_sheet</span> <span class="o">=</span> <span class="n">Sheet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="n">new_table</span><span class="p">])</span>

        <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
        <span class="n">new_sheets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_sheet</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Workbook with the sheet at index removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
        <span class="n">new_sheets</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Workbook with the sheet moved from from_index to to_index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="n">new_sheets</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
        <span class="n">new_sheets</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">sheet</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">replace_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sheet</span><span class="p">:</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Workbook with the sheet at index replaced.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

        <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
        <span class="n">new_sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">sheet</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rename_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Workbook with the sheet at index renamed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

        <span class="n">old_sheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">new_sheet</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">old_sheet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>

        <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
        <span class="n">new_sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_sheet</span>

        <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="md_spreadsheet_parser.models.Workbook.json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns a JSON-compatible dictionary representation of the workbook.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>WorkbookJSON</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="WorkbookJSON (md_spreadsheet_parser.models.WorkbookJSON)" href="#md_spreadsheet_parser.models.WorkbookJSON">WorkbookJSON</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the workbook data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Workbook.add_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_sheet</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Workbook with a new sheet added.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Workbook with a new sheet added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create new sheet with one empty table as default</span>
    <span class="n">new_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]])</span>
    <span class="n">new_sheet</span> <span class="o">=</span> <span class="n">Sheet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="n">new_table</span><span class="p">])</span>

    <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
    <span class="n">new_sheets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_sheet</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Workbook.delete_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_sheet</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Workbook with the sheet at index removed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Workbook with the sheet at index removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
    <span class="n">new_sheets</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Workbook.get_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sheet</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieve a sheet by its name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the sheet to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Sheet


  
      dataclass
   (md_spreadsheet_parser.models.Sheet)" href="#md_spreadsheet_parser.models.Sheet">Sheet</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sheet | None: The sheet object if found, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sheet</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve a sheet by its name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): The name of the sheet to retrieve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Sheet | None: The sheet object if found, otherwise None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sheet</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sheet</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Workbook.move_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_sheet</span><span class="p">(</span><span class="n">from_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Workbook with the sheet moved from from_index to to_index.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">to_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Workbook with the sheet moved from from_index to to_index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">from_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">from_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;from_index out of range&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">to_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;to_index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">new_sheets</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_index</span><span class="p">)</span>
    <span class="n">new_sheets</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">to_index</span><span class="p">,</span> <span class="n">sheet</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Workbook.rename_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename_sheet</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Workbook with the sheet at index renamed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rename_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Workbook with the sheet at index renamed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

    <span class="n">old_sheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">new_sheet</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">old_sheet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>

    <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
    <span class="n">new_sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_sheet</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Workbook.replace_sheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">replace_sheet</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">sheet</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a new Workbook with the sheet at index replaced.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">replace_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sheet</span><span class="p">:</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new Workbook with the sheet at index replaced.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Sheet index out of range&quot;</span><span class="p">)</span>

    <span class="n">new_sheets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span>
    <span class="n">new_sheets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">sheet</span>

    <span class="k">return</span> <span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheets</span><span class="o">=</span><span class="n">new_sheets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="md_spreadsheet_parser.models.Workbook.to_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_markdown</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_MULTI_TABLE_SCHEMA</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the workbook.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MultiTableParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.MultiTableParsingSchema)" href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema">MultiTableParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_MULTI_TABLE_SCHEMA">DEFAULT_MULTI_TABLE_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_markdown</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_MULTI_TABLE_SCHEMA</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the workbook.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (MultiTableParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">generate_workbook_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.models.WorkbookJSON" class="doc doc-heading">
            <code>WorkbookJSON</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>



        <p>JSON-compatible dictionary representation of a Workbook.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">WorkbookJSON</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    JSON-compatible dictionary representation of a Workbook.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">sheets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SheetJSON</span><span class="p">]</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="n">startLine</span><span class="p">:</span> <span class="n">NotRequired</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">endLine</span><span class="p">:</span> <span class="n">NotRequired</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">rootContent</span><span class="p">:</span> <span class="n">NotRequired</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="md_spreadsheet_parser.validation" class="doc doc-heading">
            <code>md_spreadsheet_parser.validation</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="md_spreadsheet_parser.validation.TableValidationError" class="doc doc-heading">
            <code>TableValidationError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>



        <p>Exception raised when table validation fails.
Contains a list of errors found during validation.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/md_spreadsheet_parser/validation.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TableValidationError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exception raised when table validation fails.</span>
<span class="sd">    Contains a list of errors found during validation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Validation failed with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2"> errors:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.validation.validate_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">schema_cls</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="o">=</span><span class="n">DEFAULT_CONVERSION_SCHEMA</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validates a Table object against a dataclass OR Pydantic schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Table object to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema_cls</code>
            </td>
            <td>
                  <code><span title="typing.Type">Type</span>[<span title="md_spreadsheet_parser.validation.T">T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataclass or Pydantic model type to validate against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conversion_schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConversionSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ConversionSchema)" href="#md_spreadsheet_parser.schemas.ConversionSchema">ConversionSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for type conversion.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_CONVERSION_SCHEMA">DEFAULT_CONVERSION_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="md_spreadsheet_parser.validation.T">T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[T]: A list of validated instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If schema_cls is not a valid schema.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="TableValidationError (md_spreadsheet_parser.validation.TableValidationError)" href="#md_spreadsheet_parser.validation.TableValidationError">TableValidationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If validation fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_table</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="s2">&quot;Table&quot;</span><span class="p">,</span>
    <span class="n">schema_cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
    <span class="n">conversion_schema</span><span class="p">:</span> <span class="n">ConversionSchema</span> <span class="o">=</span> <span class="n">DEFAULT_CONVERSION_SCHEMA</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates a Table object against a dataclass OR Pydantic schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: The Table object to validate.</span>
<span class="sd">        schema_cls: The dataclass or Pydantic model type to validate against.</span>
<span class="sd">        conversion_schema: Configuration for type conversion.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[T]: A list of validated instances.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If schema_cls is not a valid schema.</span>
<span class="sd">        TableValidationError: If validation fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check for Pydantic Model</span>
    <span class="k">if</span> <span class="n">HAS_PYDANTIC</span> <span class="ow">and</span> <span class="n">BaseModel</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">schema_cls</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableValidationError</span><span class="p">([</span><span class="s2">&quot;Table has no headers&quot;</span><span class="p">])</span>
        <span class="c1"># Import adapter lazily to avoid unused imports when pydantic is not used</span>
        <span class="c1"># (though we checked HAS_PYDANTIC so it exists)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.pydantic_adapter</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate_table_pydantic</span>

        <span class="k">return</span> <span class="n">validate_table_pydantic</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">schema_cls</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="c1"># Check for Dataclass</span>
    <span class="k">if</span> <span class="n">is_dataclass</span><span class="p">(</span><span class="n">schema_cls</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableValidationError</span><span class="p">([</span><span class="s2">&quot;Table has no headers&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">_validate_table_dataclass</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">schema_cls</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="p">)</span>

    <span class="c1"># Check for TypedDict</span>
    <span class="k">if</span> <span class="n">is_typeddict</span><span class="p">(</span><span class="n">schema_cls</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableValidationError</span><span class="p">([</span><span class="s2">&quot;Table has no headers&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">_validate_table_typeddict</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">schema_cls</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="p">)</span>

    <span class="c1"># Check for simple dict</span>
    <span class="c1"># We compare schema_cls against dict type</span>
    <span class="k">if</span> <span class="n">schema_cls</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TableValidationError</span><span class="p">([</span><span class="s2">&quot;Table has no headers&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">_validate_table_dict</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">conversion_schema</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema_cls</span><span class="si">}</span><span class="s2"> must be a dataclass, Pydantic model, TypedDict, or dict&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="md_spreadsheet_parser.generator" class="doc doc-heading">
            <code>md_spreadsheet_parser.generator</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.generator.generate_sheet_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_sheet_markdown</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_SCHEMA</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the sheet.</p>
<p>For doc sheets (type="doc"), outputs the content directly.
For table sheets (type="table"), outputs table markdown.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sheet</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Sheet


  
      dataclass
   (md_spreadsheet_parser.models.Sheet)" href="#md_spreadsheet_parser.models.Sheet">Sheet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Sheet object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_SCHEMA">DEFAULT_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_sheet_markdown</span><span class="p">(</span>
    <span class="n">sheet</span><span class="p">:</span> <span class="s2">&quot;Sheet&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the sheet.</span>

<span class="sd">    For doc sheets (type=&quot;doc&quot;), outputs the content directly.</span>
<span class="sd">    For table sheets (type=&quot;table&quot;), outputs table markdown.</span>

<span class="sd">    Args:</span>
<span class="sd">        sheet: The Sheet object.</span>
<span class="sd">        schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">MultiTableParsingSchema</span><span class="p">):</span>
        <span class="n">sheet_level</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">sheet_header_level</span> <span class="ow">or</span> <span class="mi">2</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;#&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sheet_level</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sheet</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># For doc sheets, output content directly</span>
    <span class="k">if</span> <span class="n">sheet</span><span class="o">.</span><span class="n">sheet_type</span> <span class="o">==</span> <span class="s2">&quot;doc&quot;</span> <span class="ow">and</span> <span class="n">sheet</span><span class="o">.</span><span class="n">content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Table sheet: output tables</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">table</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">tables</span><span class="p">):</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generate_table_markdown</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">schema</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Empty line between tables</span>

    <span class="c1"># Append Sheet Metadata if present (at the end)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">MultiTableParsingSchema</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sheet</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">metadata_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;!-- md-spreadsheet-sheet-metadata: </span><span class="si">{</span><span class="n">metadata_json</span><span class="si">}</span><span class="s2"> --&gt;&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.generator.generate_table_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_table_markdown</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">DEFAULT_SCHEMA</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Table


  
      dataclass
   (md_spreadsheet_parser.models.Table)" href="#md_spreadsheet_parser.models.Table">Table</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.ParsingSchema)" href="#md_spreadsheet_parser.schemas.ParsingSchema">ParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                  <code><span title="md_spreadsheet_parser.schemas.DEFAULT_SCHEMA">DEFAULT_SCHEMA</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_table_markdown</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="s2">&quot;Table&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">ParsingSchema</span> <span class="o">=</span> <span class="n">DEFAULT_SCHEMA</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: The Table object.</span>
<span class="sd">        schema (ParsingSchema, optional): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Handle metadata (name and description) if MultiTableParsingSchema</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">MultiTableParsingSchema</span><span class="p">):</span>
        <span class="n">table_level</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">table_header_level</span>
        <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="n">table_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;#&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">table_level</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Empty line after name</span>

        <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">description</span> <span class="ow">and</span> <span class="n">schema</span><span class="o">.</span><span class="n">capture_description</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Empty line after description</span>

    <span class="c1"># Build table</span>

    <span class="n">sep</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2"> &quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare cell for markdown generation.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">convert_br_to_newline</span> <span class="ow">and</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">cell</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cell</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cell</span>

    <span class="c1"># Headers</span>
    <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
        <span class="c1"># Add outer pipes if required</span>
        <span class="n">processed_headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">_prepare_cell</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
        <span class="n">header_row</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">processed_headers</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">require_outer_pipes</span><span class="p">:</span>
            <span class="n">header_row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">header_row</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header_row</span><span class="p">)</span>

        <span class="c1"># Separator row</span>
        <span class="n">separator_cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">separator_char</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">header_separator_char</span> <span class="ow">or</span> <span class="s2">&quot;-&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">headers</span><span class="p">):</span>
            <span class="n">alignment</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
            <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">alignments</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">alignments</span><span class="p">):</span>
                <span class="c1"># Ensure we handle potentially None values if list has gaps (unlikely by design but safe)</span>
                <span class="n">alignment</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">alignments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;default&quot;</span>

            <span class="c1"># Construct separator cell based on alignment</span>
            <span class="c1"># Use 3 hyphens as base</span>
            <span class="k">if</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">separator_char</span> <span class="o">*</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">separator_char</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
            <span class="k">elif</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">separator_char</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># default</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">separator_char</span> <span class="o">*</span> <span class="mi">3</span>

            <span class="n">separator_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

        <span class="n">separator_row</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">separator_cells</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">require_outer_pipes</span><span class="p">:</span>
            <span class="n">separator_row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">separator_row</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator_row</span><span class="p">)</span>

    <span class="c1"># Rows</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
        <span class="n">processed_row</span> <span class="o">=</span> <span class="p">[</span><span class="n">_prepare_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
        <span class="n">row_str</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">processed_row</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">require_outer_pipes</span><span class="p">:</span>
            <span class="n">row_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">row_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">column_separator</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_str</span><span class="p">)</span>

    <span class="c1"># Append Metadata if present</span>
    <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">and</span> <span class="s2">&quot;visual&quot;</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
        <span class="n">metadata_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;visual&quot;</span><span class="p">],</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;!-- md-spreadsheet-table-metadata: </span><span class="si">{</span><span class="n">metadata_json</span><span class="si">}</span><span class="s2"> --&gt;&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="md_spreadsheet_parser.generator.generate_workbook_markdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_workbook_markdown</span><span class="p">(</span><span class="n">workbook</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a Markdown string representation of the workbook.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>workbook</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Workbook


  
      dataclass
   (md_spreadsheet_parser.models.Workbook)" href="#md_spreadsheet_parser.models.Workbook">Workbook</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Workbook object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MultiTableParsingSchema


  
      dataclass
   (md_spreadsheet_parser.schemas.MultiTableParsingSchema)" href="#md_spreadsheet_parser.schemas.MultiTableParsingSchema">MultiTableParsingSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for formatting.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Markdown string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/md_spreadsheet_parser/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_workbook_markdown</span><span class="p">(</span>
    <span class="n">workbook</span><span class="p">:</span> <span class="s2">&quot;Workbook&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">MultiTableParsingSchema</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a Markdown string representation of the workbook.</span>

<span class="sd">    Args:</span>
<span class="sd">        workbook: The Workbook object.</span>
<span class="sd">        schema (MultiTableParsingSchema): Configuration for formatting.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Markdown string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="n">is_frontmatter</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header_type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;frontmatter&quot;</span>

    <span class="k">if</span> <span class="n">is_frontmatter</span><span class="p">:</span>
        <span class="c1"># Output YAML frontmatter block</span>
        <span class="n">frontmatter_data</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;frontmatter&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">frontmatter_data</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generate_yaml_frontmatter</span><span class="p">(</span><span class="n">frontmatter_data</span><span class="p">))</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">schema</span><span class="o">.</span><span class="n">root_marker</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">root_marker</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Default: generate root marker from workbook name</span>
        <span class="n">root_marker_level</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">schema</span><span class="o">.</span><span class="n">sheet_header_level</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">sheet_header_level</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;#&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">root_marker_level</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">workbook</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">workbook</span><span class="o">.</span><span class="n">root_content</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">workbook</span><span class="o">.</span><span class="n">root_content</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">workbook</span><span class="o">.</span><span class="n">sheets</span><span class="p">):</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generate_sheet_markdown</span><span class="p">(</span><span class="n">sheet</span><span class="p">,</span> <span class="n">schema</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">workbook</span><span class="o">.</span><span class="n">sheets</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># Empty line between sheets</span>

    <span class="c1"># Append Workbook Metadata if present (excluding internal keys)</span>
    <span class="n">comment_metadata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_METADATA_INTERNAL_KEYS</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">comment_metadata</span><span class="p">:</span>
        <span class="c1"># Ensure separation from last sheet</span>
        <span class="k">if</span> <span class="n">lines</span> <span class="ow">and</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">metadata_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">comment_metadata</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;!-- md-spreadsheet-workbook-metadata: </span><span class="si">{</span><span class="n">metadata_json</span><span class="si">}</span><span class="s2"> --&gt;&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="February 27, 2026 20:22:36 JST">2026-02-27</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="February 27, 2026 20:22:36 JST">2026-02-27</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "navigation.expand", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>